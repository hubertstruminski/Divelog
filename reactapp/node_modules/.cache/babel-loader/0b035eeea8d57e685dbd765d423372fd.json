{"ast":null,"code":"var _jsxFileName = \"/home/msi/Pulpit/Divelog/reactapp/src/components/twitter/twitter-messages/SearchPeopleConversationModal.js\";\nimport React from 'react';\nimport '../../../css/twitter-messages/SearchPeopleConversationModal.css';\nimport AuthService from '../../../util/AuthService';\nimport TwitterConversationContact from './TwitterConversationContact';\nimport $ from 'jquery';\nimport TwitterMessagesSearch from './TwitterMessagesSearch';\nimport axios from 'axios';\nimport ContactModal from './ContactModal';\nimport SelectedContact from './SelectedContact';\nimport { BACKEND_API_URL } from '../../../actions/types';\n\nclass SearchPeopleConversationModal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      contacts: [],\n      isLoading: false,\n      searchInput: '',\n      isContactsRetrieved: false,\n      selectedContacts: [],\n      isRateLimitExceeded: false\n    };\n    this.isError = false;\n    this.Auth = new AuthService();\n    this.renderContacts = this.renderContacts.bind(this);\n    this.onClose = this.onClose.bind(this);\n    this.onChange = this.onChange.bind(this);\n    this.onBlur = this.onBlur.bind(this);\n    this.addSelectedContactToList = this.addSelectedContactToList.bind(this);\n    this.renderSelectedContacts = this.renderSelectedContacts.bind(this);\n    this.removeSelectedContactFromList = this.removeSelectedContactFromList.bind(this);\n    this.checkThatContactIsSelected = this.checkThatContactIsSelected.bind(this);\n  }\n\n  onChange(e) {\n    this.setState({\n      searchInput: e.target.value\n    }, () => {\n      if (this.state.searchInput && this.state.searchInput.length > 0) {\n        this.setState({\n          isLoading: true\n        }, () => {\n          this.retrieveContacts();\n        });\n      } else if (!this.state.searchPeople) {\n        this.setState({\n          contacts: [],\n          isLoading: false\n        });\n      }\n    });\n  }\n\n  onBlur(e) {\n    if (this.state.searchInput.length === 0) {\n      this.setState({\n        contacts: []\n      });\n    }\n  }\n\n  retrieveContacts() {\n    let jwtToken = this.Auth.getRightSocialToken();\n    axios({\n      url: `${BACKEND_API_URL}/twitter/direct/messages/search/people/${jwtToken}`,\n      method: 'POST',\n      data: this.state.searchInput,\n      headers: {\n        'content-type': 'application/json'\n      }\n    }).then(response => {\n      if (response.status === 429) {\n        this.setState({\n          isRateLimitExceeded: true\n        });\n        this.isError = true;\n        return;\n      }\n\n      if (!this.isError) {\n        this.setState({\n          contacts: []\n        });\n        console.log(response.data);\n        response.data.map((contact, index) => {\n          const element = {\n            isContactPossible: contact.dmaccessible,\n            name: contact.name,\n            screenName: contact.screenName,\n            pictureUrl: contact.pictureUrl\n          };\n          this.setState({\n            contacts: this.state.contacts.concat(element)\n          });\n        });\n        this.setState({\n          isContactsRetrieved: true,\n          isLoading: false\n        }, () => {\n          $(\".twitter-messages-search-people-modal-list-contacts\").css({\n            display: \"block\"\n          });\n        });\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  renderContacts() {\n    return this.state.contacts.map((contact, index) => {\n      return React.createElement(ContactModal, {\n        key: index,\n        index: index,\n        isContactPossible: contact.isContactPossible,\n        name: contact.name,\n        screenName: contact.screenName,\n        pictureUrl: contact.pictureUrl,\n        addSelectedContactToList: this.addSelectedContactToList,\n        checkThatContactIsSelected: this.checkThatContactIsSelected,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      });\n    });\n  }\n\n  onClose(e) {\n    e.preventDefault();\n    this.props.setIsNotVisibleModalToSearch();\n  }\n\n  checkThatContactIsSelected(selectedName) {\n    let boolean = false;\n    this.state.selectedContacts.map((contact, index) => {\n      if (contact.name === selectedName) {\n        boolean = true;\n        return;\n      }\n    });\n    return boolean;\n  }\n\n  addSelectedContactToList(object) {\n    this.setState({\n      selectedContacts: this.state.selectedContacts.concat(object)\n    });\n  }\n\n  removeSelectedContactFromList(name) {\n    return this.state.selectedContacts.map((contact, index) => {\n      if (contact.name === name) {\n        this.setState({\n          selectedContacts: this.state.selectedContacts.filter((item, i) => i !== index)\n        });\n      }\n    });\n  }\n\n  renderSelectedContacts() {\n    return this.state.selectedContacts.map((contact, index) => {\n      return React.createElement(SelectedContact, {\n        name: contact.name,\n        removeSelectedContactFromList: this.removeSelectedContactFromList,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      });\n    });\n  }\n\n  render() {\n    let isLoading = this.state.isLoading;\n    let isContactsRetrieved = this.state.isContactsRetrieved;\n    let isRateLimitExceeded = this.state.isRateLimitExceeded;\n    return React.createElement(\"div\", {\n      className: \"twitter-messages-search-people-conversation-modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 160\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"twitter-messages-search-people-conversation-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"twitter-messages-search-people-header-left\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fa fa-times twitter-messages-search-people-modal-close\",\n      onClick: this.onClose,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      style: {\n        color: 'black',\n        fontWeight: 700,\n        display: 'block',\n        paddingLeft: '10%',\n        width: '100%'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }, \"New message\")), React.createElement(\"div\", {\n      className: \"twitter-messages-search-people-header-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"twitter-messages-search-people-modal-btn-next\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, \"Next\"))), React.createElement(\"input\", {\n      className: \"twitter-messages-search-people-input\",\n      type: \"text\",\n      placeholder: \"Search people\",\n      value: this.state.searchInput,\n      onChange: this.onChange,\n      onBlur: this.onBlur,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"twitter-messages-selected-contacts\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, this.renderSelectedContacts()), React.createElement(\"div\", {\n      className: \"twitter-messages-search-people-info-icon-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-user twitter-messages-search-people-icon-user\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }), \" You follow each other\"), React.createElement(\"div\", {\n      className: \"twitter-messages-search-people-modal-list-contacts\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187\n      },\n      __self: this\n    }, isLoading && React.createElement(\"div\", {\n      className: \"spinner-border text-primary\",\n      role: \"status\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      class: \"sr-only\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, \"Loading...\")), isContactsRetrieved && React.createElement(\"ul\", {\n      className: \"list-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, this.renderContacts()), true && React.createElement(\"span\", {\n      style: {\n        color: \"red\",\n        fontSize: \"0.65vw\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, \"Twitter rate limit exceeded.\")));\n  }\n\n}\n\nexport default SearchPeopleConversationModal;","map":{"version":3,"sources":["/home/msi/Pulpit/Divelog/reactapp/src/components/twitter/twitter-messages/SearchPeopleConversationModal.js"],"names":["React","AuthService","TwitterConversationContact","$","TwitterMessagesSearch","axios","ContactModal","SelectedContact","BACKEND_API_URL","SearchPeopleConversationModal","Component","constructor","props","state","contacts","isLoading","searchInput","isContactsRetrieved","selectedContacts","isRateLimitExceeded","isError","Auth","renderContacts","bind","onClose","onChange","onBlur","addSelectedContactToList","renderSelectedContacts","removeSelectedContactFromList","checkThatContactIsSelected","e","setState","target","value","length","retrieveContacts","searchPeople","jwtToken","getRightSocialToken","url","method","data","headers","then","response","status","console","log","map","contact","index","element","isContactPossible","dmaccessible","name","screenName","pictureUrl","concat","css","display","catch","err","preventDefault","setIsNotVisibleModalToSearch","selectedName","boolean","object","filter","item","i","render","color","fontWeight","paddingLeft","width","fontSize"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../../../css/twitter-messages/SearchPeopleConversationModal.css';\nimport AuthService from '../../../util/AuthService';\nimport TwitterConversationContact from './TwitterConversationContact';\nimport $ from 'jquery';\nimport TwitterMessagesSearch from './TwitterMessagesSearch';\nimport axios from 'axios';\nimport ContactModal from './ContactModal';\nimport SelectedContact from './SelectedContact';\nimport { BACKEND_API_URL } from '../../../actions/types';\n\nclass SearchPeopleConversationModal extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            contacts: [],\n            isLoading: false,\n            searchInput: '',\n            isContactsRetrieved: false,\n            selectedContacts: [],\n            isRateLimitExceeded: false\n        }\n        this.isError = false;\n\n        this.Auth = new AuthService();\n        this.renderContacts = this.renderContacts.bind(this);\n        this.onClose = this.onClose.bind(this);\n        this.onChange = this.onChange.bind(this);\n        this.onBlur = this.onBlur.bind(this);\n        this.addSelectedContactToList = this.addSelectedContactToList.bind(this);\n        this.renderSelectedContacts = this.renderSelectedContacts.bind(this);\n        this.removeSelectedContactFromList = this.removeSelectedContactFromList.bind(this);\n        this.checkThatContactIsSelected = this.checkThatContactIsSelected.bind(this);\n    }\n\n    onChange(e) {\n        this.setState({ searchInput: e.target.value }, () => {\n            if(this.state.searchInput && this.state.searchInput.length > 0) {\n                this.setState({ isLoading: true }, () => {\n                    this.retrieveContacts();\n                });\n            } else if(!this.state.searchPeople) {\n                this.setState({ \n                    contacts: [],\n                    isLoading: false\n                });\n\n            }\n        });\n    }\n\n    onBlur(e) {\n        if(this.state.searchInput.length === 0) {\n            this.setState({ contacts: [] });\n        }\n    }\n\n    retrieveContacts() {\n        let jwtToken = this.Auth.getRightSocialToken();\n\n        axios({\n            url: `${BACKEND_API_URL}/twitter/direct/messages/search/people/${jwtToken}`,\n            method: 'POST',\n            data: this.state.searchInput,\n            headers: {\n                'content-type': 'application/json'\n            }\n        }).then(response => {\n            if(response.status === 429) {\n                this.setState({ isRateLimitExceeded: true });\n                this.isError = true;\n                return;\n            }\n            if(!this.isError) {\n                this.setState({ contacts: [] });\n                console.log(response.data);\n                response.data.map((contact, index) => {\n                    const element = {\n                        isContactPossible: contact.dmaccessible,\n                        name: contact.name,\n                        screenName: contact.screenName,\n                        pictureUrl: contact.pictureUrl\n                    }\n                    this.setState({ contacts: this.state.contacts.concat(element) });\n                });\n                this.setState({ \n                    isContactsRetrieved: true,\n                    isLoading: false\n                }, () => {\n                    $(\".twitter-messages-search-people-modal-list-contacts\").css({ display: \"block\" });\n                });\n            }\n        }).catch(err => {\n            console.log(err);\n        });\n    }\n\n    renderContacts() {\n        return this.state.contacts.map((contact, index) => {\n            return (\n                <ContactModal \n                    key={index}\n                    index={index}\n                    isContactPossible={contact.isContactPossible}\n                    name={contact.name}\n                    screenName={contact.screenName}\n                    pictureUrl={contact.pictureUrl}\n                    addSelectedContactToList={this.addSelectedContactToList}\n                    checkThatContactIsSelected={this.checkThatContactIsSelected}\n                />\n            );\n        });  \n    }\n\n    onClose(e) {\n        e.preventDefault();\n        this.props.setIsNotVisibleModalToSearch();\n    }\n\n    checkThatContactIsSelected(selectedName) {\n        let boolean = false;\n        this.state.selectedContacts.map((contact, index) => {\n            if(contact.name === selectedName) {\n                boolean = true;\n                return;\n            }\n        });\n        return boolean;\n    }\n\n    addSelectedContactToList(object) {\n        this.setState({ selectedContacts: this.state.selectedContacts.concat(object) });\n    }\n\n    removeSelectedContactFromList(name) {\n        return this.state.selectedContacts.map((contact, index) => {\n            if(contact.name === name) {\n                this.setState({ selectedContacts: this.state.selectedContacts.filter((item, i) => i !== index) });\n            }\n        })\n    }\n\n    renderSelectedContacts() {\n        return this.state.selectedContacts.map((contact, index) => {\n            return (\n                <SelectedContact \n                    name={contact.name}\n                    removeSelectedContactFromList={this.removeSelectedContactFromList}\n                />\n            );\n        });\n    }\n\n    render() {\n        let isLoading = this.state.isLoading;\n        let isContactsRetrieved = this.state.isContactsRetrieved;\n        let isRateLimitExceeded = this.state.isRateLimitExceeded;\n        return (\n            <div className=\"twitter-messages-search-people-conversation-modal\">\n                <div className=\"twitter-messages-search-people-conversation-header\">\n                    <div className=\"twitter-messages-search-people-header-left\">\n                        <i \n                            className=\"fa fa-times twitter-messages-search-people-modal-close\"\n                            onClick={this.onClose}\n                        ></i>\n                        <span style={{ color: 'black', fontWeight: 700, display: 'block', paddingLeft: '10%', width: '100%' }}>New message</span>\n                    </div>\n                    <div className=\"twitter-messages-search-people-header-right\">\n                        <button className=\"twitter-messages-search-people-modal-btn-next\">Next</button>\n                    </div>\n                </div>\n                <input \n                    className=\"twitter-messages-search-people-input\" \n                    type=\"text\" \n                    placeholder=\"Search people\"\n                    value={this.state.searchInput}\n                    onChange={this.onChange}\n                    onBlur={this.onBlur}\n                />\n                <div className=\"twitter-messages-selected-contacts\">\n                    { this.renderSelectedContacts() }\n                </div>\n                <div className=\"twitter-messages-search-people-info-icon-title\">\n                    <i className=\"fas fa-user twitter-messages-search-people-icon-user\"></i> You follow each other\n                </div>\n                <div className=\"twitter-messages-search-people-modal-list-contacts\">\n                    { isLoading && \n                        <div \n                            className='spinner-border text-primary' \n                            role='status'\n                        >\n                            <span class='sr-only'>\n                                Loading...\n                            </span>\n                        </div>\n                    }\n                    {\n                        isContactsRetrieved &&\n\n                        <ul className=\"list-group\">\n                            { this.renderContacts() }\n                        </ul>\n                    }\n                    {\n                        true &&\n                        <span style={{ color: \"red\", fontSize: \"0.65vw\" }}>Twitter rate limit exceeded.</span>\n                    }\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default SearchPeopleConversationModal;"]},"metadata":{},"sourceType":"module"}