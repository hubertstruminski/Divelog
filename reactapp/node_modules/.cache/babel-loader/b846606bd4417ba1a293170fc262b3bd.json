{"ast":null,"code":"var _jsxFileName = \"/home/huber/Pulpit/divelog/react-divelog/src/components/forum/Topic.js\";\nimport React from 'react';\nimport '../../css/Topic.css';\nimport { withRouter } from 'react-router';\nimport axios from 'axios';\nimport swal from 'sweetalert';\nimport $ from 'jquery';\n\nclass Topic extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      numberDisplays: 0,\n      numberComments: 0,\n      likes: 0,\n      vote: 0,\n      isUpVoted: false,\n      isDownVoted: false\n    };\n    this.onTopicClick = this.onTopicClick.bind(this);\n    this.onUpVote = this.onUpVote.bind(this);\n    this.onDownVote = this.onDownVote.bind(this);\n    this.fetchTopicData = this.fetchTopicData.bind(this);\n  }\n\n  componentDidMount() {\n    let jwtToken = localStorage.getItem(\"JwtToken\");\n    let topicId = this.props.id;\n    fetch(\"/get/topic/number/comments/\".concat(topicId, \"/\").concat(jwtToken), {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/json, text/plain, */*',\n        'content-type': 'application/json'\n      }\n    }).then(response => response.json()).then(jsonData => {\n      console.log(jsonData);\n      this.setState({\n        numberDisplays: jsonData.numberDisplay,\n        numberComments: jsonData.numberComments,\n        likes: jsonData.likes,\n        vote: jsonData.vote\n      }, () => {\n        if (this.state.vote === 1) {\n          $(\".grid-topic-one:eq(\".concat(this.props.count, \") .fa-chevron-circle-up:eq(\").concat(this.props.count, \")\")).css({\n            \"color\": \"red\"\n          });\n          this.setState({\n            isUpVoted: true\n          });\n        } else if (this.state.vote === -1) {\n          $(\".grid-topic-one:eq(\".concat(this.props.count, \") .fa-chevron-circle-down:eq(\").concat(this.props.count, \")\")).css({\n            \"color\": \"red\"\n          });\n          this.setState({\n            isDownVoted: true\n          });\n        } else {\n          $(\".grid-topic-one:eq(\".concat(this.props.count, \") .fa-chevron-circle-up:eq(\").concat(this.props.count, \")\")).css({\n            \"color\": \"white\"\n          });\n          $(\".grid-topic-one:eq(\".concat(this.props.count, \") .fa-chevron-circle-down:eq(\").concat(this.props.count, \")\")).css({\n            \"color\": \"white\"\n          });\n          this.setState({\n            isDownVoted: false,\n            isUpVoted: false\n          });\n        }\n      });\n    });\n  }\n\n  onTopicClick(e) {\n    e.preventDefault();\n    this.props.history.push(\"/topic/\".concat(this.props.id, \"/\").concat(this.props.languageForum, \"/posts\"));\n  }\n\n  onUpVote() {\n    let jwtToken = localStorage.getItem(\"JwtToken\");\n\n    if (!this.state.isUpVoted) {\n      let isUpVoted = true;\n      axios({\n        method: 'PUT',\n        url: \"/topic/likes/vote/\".concat(this.props.id, \"/\").concat(jwtToken),\n        data: isUpVoted,\n        headers: {\n          \"Accept\": \"application/json\",\n          \"Content-type\": \"application/json\"\n        }\n      }).then(response => {\n        if (response.status !== 200) {\n          swal(\"Error\", \"Something goes wrong.\", \"error\");\n        } else {\n          this.setState({\n            numberDisplays: 0,\n            numberComments: 0,\n            likes: 0,\n            isUpVoted: true,\n            isDownVoted: false\n          }, () => {\n            $(\".grid-topic-one:eq(\".concat(this.props.count, \") .fa-chevron-circle-up:eq(\").concat(this.props.count, \")\")).css({\n              \"color\": \"red\"\n            });\n            $(\".grid-topic-one:eq(\".concat(this.props.count, \") .fa-chevron-circle-down:eq(\").concat(this.props.count, \")\")).css({\n              \"color\": \"white\"\n            });\n            this.fetchTopicData();\n          });\n        }\n      });\n    }\n  }\n\n  onDownVote() {\n    let jwtToken = localStorage.getItem(\"JwtToken\");\n\n    if (!this.state.isDownVoted) {\n      let isUpVoted = false;\n      axios({\n        method: 'PUT',\n        url: \"/topic/likes/vote/\".concat(this.props.id, \"/\").concat(jwtToken),\n        data: isUpVoted,\n        headers: {\n          \"Accept\": \"application/json\",\n          \"Content-type\": \"application/json\"\n        }\n      }).then(response => {\n        if (response.status !== 200) {\n          swal(\"Error\", \"Something goes wrong.\", \"error\");\n        } else {\n          this.setState({\n            numberDisplays: 0,\n            numberComments: 0,\n            likes: 0,\n            isDownVoted: true,\n            isUpVoted: false\n          }, () => {\n            $(\".grid-topic-one:eq(\".concat(this.props.count, \") .fa-chevron-circle-up:eq(\").concat(this.props.count, \")\")).css({\n              \"color\": \"white\"\n            });\n            $(\".grid-topic-one:eq(\".concat(this.props.count, \") .fa-chevron-circle-down:eq(\").concat(this.props.count, \")\")).css({\n              \"color\": \"red\"\n            });\n            this.fetchTopicData();\n          });\n        }\n      });\n    }\n  }\n\n  fetchTopicData() {\n    let jwtToken = localStorage.getItem(\"JwtToken\");\n    let topicId = this.props.id;\n    fetch(\"/get/topic/number/comments/\".concat(topicId, \"/\").concat(jwtToken), {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/json, text/plain, */*',\n        'content-type': 'application/json'\n      }\n    }).then(response => response.json()).then(jsonData => {\n      console.log(jsonData);\n      this.setState({\n        numberDisplays: jsonData.numberDisplay,\n        numberComments: jsonData.numberComments,\n        likes: jsonData.likes,\n        vote: jsonData.vote\n      }, () => {\n        if (this.state.vote === 1) {\n          $(\".fa-chevron-circle-up:eq(\".concat(this.props.count, \")\")).css({\n            \"color\": \"red\"\n          });\n          this.setState({\n            isUpVoted: true\n          });\n        } else if (this.state.vote === -1) {\n          $(\".fa-chevron-circle-down:eq(\".concat(this.props.count, \")\")).css({\n            \"color\": \"red\"\n          });\n          this.setState({\n            isDownVoted: true\n          });\n        } else {\n          $(\".fa-chevron-circle-up:eq(\".concat(this.props.count, \")\")).css({\n            \"color\": \"white\"\n          });\n          $(\".fa-chevron-circle-down:eq(\".concat(this.props.count, \")\")).css({\n            \"color\": \"white\"\n          });\n          this.setState({\n            isDownVoted: false,\n            isUpVoted: false\n          });\n        }\n      });\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"topic-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"topic-body\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"grid-topic-one\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-chevron-circle-up like-icon\",\n      onClick: this.onUpVote,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"counter\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, this.state.likes), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fas fa-chevron-circle-down like-icon\",\n      onClick: this.onDownVote,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"grid-topic-two\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"title-topic\",\n      onClick: this.onTopicClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, this.props.title), React.createElement(\"div\", {\n      className: \"owner-topic\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"floating-div\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, this.props.owner), React.createElement(\"span\", {\n      className: \"floating-div float-two-right\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, this.props.createdAt), React.createElement(\"div\", {\n      style: {\n        clear: 'both'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      className: \"grid-topic-three\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, this.state.numberComments, \" comments\", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }), this.state.numberDisplays, \" display\"))));\n  }\n\n}\n\nexport default withRouter(Topic);","map":{"version":3,"sources":["/home/huber/Pulpit/divelog/react-divelog/src/components/forum/Topic.js"],"names":["React","withRouter","axios","swal","$","Topic","Component","constructor","props","state","numberDisplays","numberComments","likes","vote","isUpVoted","isDownVoted","onTopicClick","bind","onUpVote","onDownVote","fetchTopicData","componentDidMount","jwtToken","localStorage","getItem","topicId","id","fetch","method","headers","then","response","json","jsonData","console","log","setState","numberDisplay","count","css","e","preventDefault","history","push","languageForum","url","data","status","render","title","owner","createdAt","clear"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../../css/Topic.css';\nimport { withRouter } from 'react-router';\nimport axios from 'axios';\nimport swal from 'sweetalert';\nimport $ from 'jquery';\n\nclass Topic extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            numberDisplays: 0,\n            numberComments: 0,\n            likes: 0,\n            vote: 0,\n            isUpVoted: false,\n            isDownVoted: false\n        }\n        this.onTopicClick = this.onTopicClick.bind(this);\n        this.onUpVote = this.onUpVote.bind(this);\n        this.onDownVote = this.onDownVote.bind(this);\n        this.fetchTopicData = this.fetchTopicData.bind(this);\n    }\n\n    componentDidMount() {\n        let jwtToken = localStorage.getItem(\"JwtToken\"); \n        let topicId = this.props.id;\n\n        fetch(`/get/topic/number/comments/${topicId}/${jwtToken}`, {\n            method: 'GET',\n            headers: {\n                'Accept': 'application/json, text/plain, */*',\n                'content-type': 'application/json'\n            }\n        }).then(response => response.json())\n        .then(jsonData => {\n            console.log(jsonData);\n            this.setState({\n                numberDisplays: jsonData.numberDisplay,\n                numberComments: jsonData.numberComments,\n                likes: jsonData.likes,\n                vote: jsonData.vote\n            }, () => {\n                if(this.state.vote === 1) {\n                    $(`.grid-topic-one:eq(${this.props.count}) .fa-chevron-circle-up:eq(${this.props.count})`).css({ \"color\": \"red\" });\n                    this.setState({ isUpVoted: true });\n                } else if(this.state.vote === -1) {\n                    $(`.grid-topic-one:eq(${this.props.count}) .fa-chevron-circle-down:eq(${this.props.count})`).css({ \"color\": \"red\" });\n                    this.setState({ isDownVoted: true });\n                } else {\n                    $(`.grid-topic-one:eq(${this.props.count}) .fa-chevron-circle-up:eq(${this.props.count})`).css({ \"color\": \"white\" });\n                    $(`.grid-topic-one:eq(${this.props.count}) .fa-chevron-circle-down:eq(${this.props.count})`).css({ \"color\": \"white\" });\n                    this.setState({ \n                        isDownVoted: false,\n                        isUpVoted: false\n                    });\n                }\n            });\n        });\n    }\n\n    onTopicClick(e) {\n        e.preventDefault();\n        this.props.history.push(`/topic/${this.props.id}/${this.props.languageForum}/posts`);\n    }\n\n    onUpVote() {\n        let jwtToken = localStorage.getItem(\"JwtToken\");\n        if(!this.state.isUpVoted) {\n            let isUpVoted = true;    \n            axios({\n                method: 'PUT',\n                url: `/topic/likes/vote/${this.props.id}/${jwtToken}`,\n                data: isUpVoted,\n                headers: {\n                    \"Accept\": \"application/json\",\n                    \"Content-type\": \"application/json\"\n                }\n            }).then(response => {\n                if(response.status !== 200) {\n                    swal(\"Error\", \"Something goes wrong.\", \"error\");\n                } else {\n                    this.setState({\n                        numberDisplays: 0,\n                        numberComments: 0,\n                        likes: 0,\n                        isUpVoted: true,\n                        isDownVoted: false\n                    }, () => {\n                        $(`.grid-topic-one:eq(${this.props.count}) .fa-chevron-circle-up:eq(${this.props.count})`).css({ \"color\": \"red\" });\n                        $(`.grid-topic-one:eq(${this.props.count}) .fa-chevron-circle-down:eq(${this.props.count})`).css({ \"color\": \"white\"});\n                        this.fetchTopicData();\n                    });\n                }\n            });\n        } \n    }\n\n    onDownVote() {\n        let jwtToken = localStorage.getItem(\"JwtToken\");\n        if(!this.state.isDownVoted) {\n            let isUpVoted = false;\n            axios({\n                method: 'PUT',\n                url: `/topic/likes/vote/${this.props.id}/${jwtToken}`,\n                data: isUpVoted,\n                headers: {\n                    \"Accept\": \"application/json\",\n                    \"Content-type\": \"application/json\"\n                }\n            }).then(response => {\n                if(response.status !== 200) {\n                    swal(\"Error\", \"Something goes wrong.\", \"error\");\n                } else {\n                    this.setState({\n                        numberDisplays: 0,\n                        numberComments: 0,\n                        likes: 0,\n                        isDownVoted: true,\n                        isUpVoted: false\n                    }, () => {\n                        $(`.grid-topic-one:eq(${this.props.count}) .fa-chevron-circle-up:eq(${this.props.count})`).css({ \"color\": \"white\" });\n                        $(`.grid-topic-one:eq(${this.props.count}) .fa-chevron-circle-down:eq(${this.props.count})`).css({ \"color\": \"red\"});\n                        this.fetchTopicData();\n                    });\n                }\n            });\n        }\n    }\n\n    fetchTopicData() {\n        let jwtToken = localStorage.getItem(\"JwtToken\"); \n        let topicId = this.props.id;\n        \n        fetch(`/get/topic/number/comments/${topicId}/${jwtToken}`, {\n            method: 'GET',\n            headers: {\n                'Accept': 'application/json, text/plain, */*',\n                'content-type': 'application/json'\n            }\n        }).then(response => response.json())\n        .then(jsonData => {\n            console.log(jsonData);\n            this.setState({\n                numberDisplays: jsonData.numberDisplay,\n                numberComments: jsonData.numberComments,\n                likes: jsonData.likes,\n                vote: jsonData.vote\n            }, () => {\n                if(this.state.vote === 1) {\n                    $(`.fa-chevron-circle-up:eq(${this.props.count})`).css({ \"color\": \"red\" });\n                    this.setState({ isUpVoted: true });\n                } else if(this.state.vote === -1) {\n                    $(`.fa-chevron-circle-down:eq(${this.props.count})`).css({ \"color\": \"red\" });\n                    this.setState({ isDownVoted: true });\n                } else {\n                    $(`.fa-chevron-circle-up:eq(${this.props.count})`).css({ \"color\": \"white\" });\n                    $(`.fa-chevron-circle-down:eq(${this.props.count})`).css({ \"color\": \"white\" });\n                    this.setState({ \n                        isDownVoted: false,\n                        isUpVoted: false\n                    });\n                }\n            });\n        });\n    }\n\n    render() {\n        return(\n            <div className=\"topic-container\">\n                <div className=\"topic-body\">\n                    <div className=\"grid-topic-one\">\n                        <div>\n                            <i \n                                className=\"fas fa-chevron-circle-up like-icon\"\n                                onClick={this.onUpVote}\n                            >\n                            </i>\n                        </div>\n                        <div className=\"counter\">\n                            { this.state.likes }\n                        </div>\n                        <div>\n                            <i \n                                className=\"fas fa-chevron-circle-down like-icon\"\n                                onClick={this.onDownVote}\n                            >\n                            </i>\n                        </div>\n                    </div>\n                    <div className=\"grid-topic-two\">\n                        <div className=\"title-topic\" onClick={this.onTopicClick}>\n                            { this.props.title }\n                        </div>\n                        <div className=\"owner-topic\">\n                            <span className=\"floating-div\">\n                                { this.props.owner }\n                            </span>\n\n                            <span className=\"floating-div float-two-right\">\n                                {this.props.createdAt }\n                            </span>\n\n                            <div style={{ clear: 'both' }}></div>\n                        </div>\n                    </div>\n                    <div className=\"grid-topic-three\">\n                        <div>\n                            { this.state.numberComments } comments\n                            <br />\n                            { this.state.numberDisplays } display\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default withRouter(Topic);"]},"metadata":{},"sourceType":"module"}