{"ast":null,"code":"var _jsxFileName = \"/home/huber/Pulpit/divelog/react-divelog/src/components/forum/Post.js\";\nimport React from 'react';\nimport '../../css/TopicWithPosts.css';\nimport '../../css/AddPosts.css';\nimport ReactPlayer from 'react-player';\nimport swal from 'sweetalert';\nimport $ from 'jquery';\nimport ReactFilestack from 'filestack-react';\n\nclass Post extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      email: '',\n      isOwner: false,\n      isUpdating: false\n    };\n    this.addImages = this.addImages.bind(this);\n    this.addVideos = this.addVideos.bind(this);\n    this.onDeleteClick = this.onDeleteClick.bind(this);\n    this.onEditClick = this.onEditClick.bind(this);\n  }\n\n  componentDidMount() {\n    let jwtToken = localStorage.getItem(\"JwtToken\");\n    fetch(\"/getuserdata/\".concat(jwtToken), {\n      method: 'GET',\n      headers: {\n        'content-type': 'application/json'\n      }\n    }).then(response => response.json()).then(jsonData => {\n      this.setState({\n        email: jsonData.email\n      }, () => {\n        if (this.props.user.email === this.state.email) {\n          this.setState({\n            isOwner: true\n          });\n        }\n      });\n    });\n  }\n\n  addImages() {\n    return this.props.files.map((file, index) => {\n      if (file.type.includes('image')) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 47\n          },\n          __self: this\n        }, React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 48\n          },\n          __self: this\n        }), React.createElement(\"img\", {\n          src: file.url,\n          alt: file.name,\n          className: \"attachment-images\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 49\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 54\n          },\n          __self: this\n        }), file.name, React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 56\n          },\n          __self: this\n        }));\n      }\n    });\n  }\n\n  addVideos() {\n    return this.props.files.map((file, index) => {\n      if (file.type.includes('video')) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 67\n          },\n          __self: this\n        }, React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 68\n          },\n          __self: this\n        }), React.createElement(ReactPlayer, {\n          url: file.url,\n          playing: true,\n          controls: \"true\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 69\n          },\n          __self: this\n        }), React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 74\n          },\n          __self: this\n        }), file.name, React.createElement(\"br\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 76\n          },\n          __self: this\n        }));\n      }\n    });\n  }\n\n  onDeleteClick() {\n    let postId = this.props.id;\n    let jwtToken = localStorage.getItem(\"JwtToken\");\n    fetch(\"/delete/post/\".concat(postId, \"/\").concat(jwtToken), {\n      method: 'DELETE',\n      headers: {\n        'Accept': 'application/json, text/plain, */*',\n        'content-type': 'application/json'\n      }\n    }).then(response => {\n      if (response.status !== 200) {\n        swal(\"Error\", \"Something goes wrong.\", \"error\");\n      } else {\n        this.props.fetchTopicAndPosts();\n        swal(\"Success\", \"Post has been removed successfully.\", \"success\");\n      }\n    });\n  }\n\n  onEditClick() {\n    console.log(this.state.isUpdating);\n\n    if (!this.state.isUpdating) {\n      this.setState({\n        isUpdating: true\n      }, () => {\n        let counter = this.props.counter;\n        let message = $(\".post-message:eq(\".concat(counter, \")\")).html();\n        $(\".post-message:eq(\".concat(counter, \")\")).html(\"\").append($(\"<div></div>\").addClass(\"form-group edit-post-div\"));\n        $(\".post-message:eq(\".concat(counter, \") > .edit-post-div\")).append($(\"<textarea></textarea\").attr(\"rows\", \"7\").addClass(\"new-post-textarea edit-textarea\"));\n        $(\".post-buttons:eq(\".concat(counter, \")\")).append($(\"<button>Confirm</button>\").attr(\"id\", \"btnConfirm\").addClass(\"btn btn-success btn-success-float\"));\n        $(\".post-buttons\").not(\".post-buttons:eq(\".concat(counter, \")\")).css({\n          \"display\": \"none\"\n        });\n        $(\".post-message:eq(\".concat(counter, \") > .edit-post-div > .edit-textarea\")).val(message);\n        $(\"#btnConfirm\").click(function () {\n          alert(\"Hubert\");\n        });\n      });\n    }\n  }\n\n  onConfirmClick() {\n    alert(\"Hubert Strumiński\");\n  }\n\n  showSuccessUploadedFiles(isSuccessUploaded) {\n    if (isSuccessUploaded) {\n      return React.createElement(\"div\", {\n        className: \"alert alert-warning\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, \"Success uploaded files:\", this.state.successNameFiles.map((name, index) => {\n        return React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136\n          },\n          __self: this\n        }, name);\n      }));\n    }\n\n    return null;\n  }\n\n  showFailureUploadedFiles(isFailureUploaded) {\n    if (isFailureUploaded) {\n      return React.createElement(\"div\", {\n        className: \"alert alert-danger\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, \"Failure uploaded files:\", this.state.failureNameFiles.map((name, index) => {\n        return React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 150\n          },\n          __self: this\n        }, name);\n      }));\n    }\n\n    return null;\n  }\n\n  render() {\n    let isOwner = this.state.isOwner;\n    let isUpdating = this.state.isUpdating;\n    return React.createElement(\"div\", {\n      className: \"main-post-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"main-post-container post-margin\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"main-post-grid-one\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"main-post-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, this.props.createdAt), React.createElement(\"div\", {\n      className: \"main-post-avatar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: this.props.user.pictureUrl,\n      alt: \"Avatar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"main-post-footer\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172\n      },\n      __self: this\n    }, this.props.user.name)), React.createElement(\"div\", {\n      className: \"main-post-grid-two\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"post-message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177\n      },\n      __self: this\n    }, this.props.message), React.createElement(\"div\", {\n      className: \"main-post-attachments\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, this.addImages(), this.addVideos()), React.createElement(\"div\", {\n      className: \"post-buttons\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, isOwner && !isUpdating && React.createElement(React.Fragment, null, React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"btn btn-warning\",\n      onClick: this.onEditClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, \"EDIT\"), React.createElement(\"button\", {\n      className: \"btn btn-danger\",\n      onClick: this.onDeleteClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, \"DELETE\")), isUpdating && React.createElement(\"div\", {\n      className: \"form-group edit-post-upload-files-div\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, \"Upload data\"), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }), React.createElement(ReactFilestack, {\n      apikey: \"Abn3RoxlVQeWNtMpk2Gflz\",\n      onSuccess: this.responseFilestack,\n      onError: this.onErrorFilestack,\n      componentDisplayMode: {\n        type: 'button',\n        customText: 'Upload files',\n        customClass: 'btn btn-warning edit-post-upload-file'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      style: {\n        clear: \"both\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }), this.showSuccessUploadedFiles(this.state.isSuccessUploaded), this.showFailureUploadedFiles(this.state.isFailureUploaded))))));\n  }\n\n}\n\nexport default Post;","map":{"version":3,"sources":["/home/huber/Pulpit/divelog/react-divelog/src/components/forum/Post.js"],"names":["React","ReactPlayer","swal","$","ReactFilestack","Post","Component","constructor","props","state","email","isOwner","isUpdating","addImages","bind","addVideos","onDeleteClick","onEditClick","componentDidMount","jwtToken","localStorage","getItem","fetch","method","headers","then","response","json","jsonData","setState","user","files","map","file","index","type","includes","url","name","postId","id","status","fetchTopicAndPosts","console","log","counter","message","html","append","addClass","attr","not","css","val","click","alert","onConfirmClick","showSuccessUploadedFiles","isSuccessUploaded","successNameFiles","showFailureUploadedFiles","isFailureUploaded","failureNameFiles","render","createdAt","pictureUrl","responseFilestack","onErrorFilestack","customText","customClass","clear"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../../css/TopicWithPosts.css';\nimport '../../css/AddPosts.css';\nimport ReactPlayer from 'react-player';\nimport swal from 'sweetalert';\nimport $ from 'jquery';\nimport ReactFilestack from 'filestack-react';\n\nclass Post extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            email: '',\n            isOwner: false,\n            isUpdating: false\n        }\n        this.addImages = this.addImages.bind(this);\n        this.addVideos = this.addVideos.bind(this);\n        this.onDeleteClick = this.onDeleteClick.bind(this);\n        this.onEditClick = this.onEditClick.bind(this);\n    }\n\n    componentDidMount() {\n        let jwtToken = localStorage.getItem(\"JwtToken\");\n\n        fetch(`/getuserdata/${jwtToken}`, {\n            method: 'GET',\n            headers: {\n              'content-type': 'application/json'\n            }\n        })\n        .then(response => response.json())\n        .then(jsonData => {\n            this.setState({ email: jsonData.email }, () => {\n                if(this.props.user.email === this.state.email) {\n                    this.setState({ isOwner: true });\n                }\n            });\n        }); \n    }\n\n    addImages() {\n        return this.props.files.map((file, index) => {\n            if(file.type.includes('image')) {\n                return (\n                    <div>\n                        <br />\n                        <img \n                            src={file.url} \n                            alt={file.name} \n                            className=\"attachment-images\"\n                        />\n                        <br />\n                        { file.name }\n                        <br />\n                    </div>\n                );\n            }\n        });\n    }\n\n    addVideos() {\n        return this.props.files.map((file, index) => {\n            if(file.type.includes('video')) {\n                return (\n                    <div>\n                        <br />\n                        <ReactPlayer \n                            url={file.url} \n                            playing\n                            controls=\"true\"\n                        />\n                        <br />\n                        { file.name }\n                        <br />\n                    </div>\n                );\n            }\n        })\n    }\n\n    onDeleteClick() {\n        let postId = this.props.id;\n        let jwtToken = localStorage.getItem(\"JwtToken\");\n\n        fetch(`/delete/post/${postId}/${jwtToken}`, {\n            method: 'DELETE',\n            headers: {\n                'Accept': 'application/json, text/plain, */*',\n                'content-type': 'application/json'\n            }\n        }).then(response => {\n            if(response.status !== 200) {\n                swal(\"Error\", \"Something goes wrong.\", \"error\");\n            } else {\n                this.props.fetchTopicAndPosts();\n                swal(\"Success\", \"Post has been removed successfully.\", \"success\");\n            }\n        });\n    }\n\n    onEditClick() {\n        console.log(this.state.isUpdating);\n\n        if(!this.state.isUpdating) {\n            this.setState({ isUpdating: true }, () => {\n                let counter = this.props.counter;\n                let message = $(`.post-message:eq(${counter})`).html();\n\n                $(`.post-message:eq(${counter})`).html(\"\").append($(\"<div></div>\").addClass(\"form-group edit-post-div\"))\n                $(`.post-message:eq(${counter}) > .edit-post-div`).append($(\"<textarea></textarea\").attr(\"rows\", \"7\").addClass(\"new-post-textarea edit-textarea\"));\n                $(`.post-buttons:eq(${counter})`).append($(\"<button>Confirm</button>\").attr(\"id\", \"btnConfirm\").addClass(\"btn btn-success btn-success-float\"));\n        \n                $(\".post-buttons\").not(`.post-buttons:eq(${counter})`).css({ \"display\": \"none\"});\n\n                $(`.post-message:eq(${counter}) > .edit-post-div > .edit-textarea`).val(message);\n\n                $(\"#btnConfirm\").click(function() {\n                    alert(\"Hubert\");\n                });\n            });\n        }\n    }\n\n    onConfirmClick() {\n        alert(\"Hubert Strumiński\");\n    }\n\n    showSuccessUploadedFiles(isSuccessUploaded) {\n        if(isSuccessUploaded) {\n            return (\n                <div className=\"alert alert-warning\">\n                    Success uploaded files:\n                    { this.state.successNameFiles.map((name, index) => {\n                        return <p>{name}</p>\n                    })}\n                </div>\n            );\n        }\n        return null;\n    }\n\n    showFailureUploadedFiles(isFailureUploaded) {\n        if(isFailureUploaded) {\n            return (\n                <div className=\"alert alert-danger\">\n                    Failure uploaded files:\n                    { this.state.failureNameFiles.map((name, index) => {\n                        return <p>{name}</p>\n                    })}\n                </div>\n            );\n        }\n        return null;\n    }\n\n    render() {\n        let isOwner = this.state.isOwner;\n        let isUpdating = this.state.isUpdating;\n\n        return (\n            <div className=\"main-post-center\">\n                <div className=\"main-post-container post-margin\">\n                    <div className=\"main-post-grid-one\">\n                        <div className=\"main-post-header\">\n                            { this.props.createdAt }\n                        </div>\n                        <div className=\"main-post-avatar\">\n                            <img src={this.props.user.pictureUrl} alt=\"Avatar\" />\n                        </div>\n                        <div className=\"main-post-footer\">\n                            { this.props.user.name }\n                        </div>\n                    </div>\n                    <div className=\"main-post-grid-two\">\n                        <div className=\"post-message\">\n                            { this.props.message }\n                        </div>\n                        <div className=\"main-post-attachments\">\n                            { this.addImages() }\n                            { this.addVideos() }\n                        </div>\n                \n                        <div className=\"post-buttons\">\n                            { isOwner && !isUpdating &&\n                                <>\n                                    <hr />\n                                    <button \n                                        className=\"btn btn-warning\"\n                                        onClick={this.onEditClick}\n                                    >\n                                        EDIT\n                                    </button>\n                                \n                                    <button \n                                        className=\"btn btn-danger\"\n                                        onClick={this.onDeleteClick}\n                                    >\n                                        DELETE\n                                    </button>\n                                </>\n                            }\n                            {\n                                isUpdating && (\n\n                                <div className=\"form-group edit-post-upload-files-div\">\n                                    <label>Upload data</label>\n                                    <br />\n                                    <ReactFilestack\n                                        apikey=\"Abn3RoxlVQeWNtMpk2Gflz\"\n                                        onSuccess={this.responseFilestack}\n                                        onError={this.onErrorFilestack}\n                                        componentDisplayMode={{\n                                            type: 'button',\n                                            customText: 'Upload files',\n                                            customClass: 'btn btn-warning edit-post-upload-file'\n                                        }}\n                                    />\n                                    <div style={{ clear: \"both\" }}></div>\n                                    { this.showSuccessUploadedFiles(this.state.isSuccessUploaded) }\n                                    { this.showFailureUploadedFiles(this.state.isFailureUploaded) }\n                                </div>\n                                )\n                            }\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default Post;"]},"metadata":{},"sourceType":"module"}