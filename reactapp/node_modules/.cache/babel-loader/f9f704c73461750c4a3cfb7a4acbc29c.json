{"ast":null,"code":"var _jsxFileName = \"/home/huber/Pulpit/Divelog/reactapp/src/components/googleMaps/GoogleMap.js\";\nimport React from 'react';\nimport '../../css/GoogleMap.css';\nimport { Map, Marker, GoogleApiWrapper, InfoWindow } from 'google-maps-react';\nimport GoogleModal from './GoogleModal';\nimport $ from 'jquery';\nimport DeleteButton from './DeleteButton';\nimport { withTranslation } from 'react-i18next';\nimport { compose } from 'redux';\nimport AuthService from '../../util/AuthService';\nimport { BACKEND_API_URL } from '../../actions/types';\n\nclass GoogleMap extends React.Component {\n  constructor(_props) {\n    super(_props);\n\n    this.showMarkers = () => {\n      return this.state.markers.map((marker, index) => {\n        return React.createElement(Marker, {\n          key: index,\n          name: marker.name,\n          position: {\n            lat: marker.latitude,\n            lng: marker.longitude\n          },\n          onClick: this.onMarkerClick,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104\n          },\n          __self: this\n        });\n      });\n    };\n\n    this.showTableRows = () => {\n      let i = 0;\n      return this.state.markers.map((marker, index) => {\n        return React.createElement(\"tr\", {\n          key: index,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }, React.createElement(\"th\", {\n          scope: \"row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }, React.createElement(\"b\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120\n          },\n          __self: this\n        }, ++i)), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122\n          },\n          __self: this\n        }, marker.name), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        }, marker.latitude), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124\n          },\n          __self: this\n        }, marker.longitude), React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }, React.createElement(DeleteButton, {\n          id: marker.id,\n          setIsDeletedMarker: this.setIsDeletedMarker,\n          setDeletedMarkerId: this.setDeletedMarkerId,\n          fetchMarkers: this.fetchMarkers,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        })));\n      });\n    };\n\n    this.onMarkerClick = (props, marker, e) => {\n      this.setState({\n        selectedPlace: props,\n        activeMarker: marker,\n        showingInfoWindow: true\n      });\n    };\n\n    this.onClose = props => {\n      if (this.state.showingInfoWindow) {\n        this.setState({\n          showingInfoWindow: false,\n          activeMarker: null\n        });\n      }\n    };\n\n    this.state = {\n      isLoading: true,\n      showingInfoWindow: false,\n      activeMarker: {},\n      selectedPlace: {},\n      markers: [],\n      isFinishMarker: false,\n      latitude: '',\n      longitude: '',\n      isDeletedMarker: false,\n      deletedMarkerId: 0\n    };\n    this.Auth = new AuthService();\n    this.onMapClick = this.onMapClick.bind(this);\n    this.setFinishMarker = this.setFinishMarker.bind(this);\n    this.setIsDeletedMarker = this.setIsDeletedMarker.bind(this);\n    this.fetchMarkers = this.fetchMarkers.bind(this);\n    this.setDeletedMarkerId = this.setDeletedMarkerId.bind(this);\n    this.addMarkerToArray = this.addMarkerToArray.bind(this);\n  }\n\n  componentDidMount() {\n    this.setState({\n      isLoading: false\n    });\n    let jwtToken = this.Auth.getRightSocialToken();\n    fetch(\"\".concat(BACKEND_API_URL, \"/get/markers/\").concat(jwtToken), {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(response => {\n      return response.json();\n    }).then(jsonData => {\n      console.log(jsonData);\n\n      if (jsonData.length !== 0) {\n        jsonData.map((marker, index) => {\n          let element = {\n            id: marker.id,\n            name: marker.name,\n            latitude: marker.latitude,\n            longitude: marker.longitude\n          };\n          this.setState({\n            markers: this.state.markers.concat(element)\n          });\n        });\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  }\n\n  fetchMarkers() {\n    let jwtToken = this.Auth.getRightSocialToken();\n    this.setState({\n      markers: []\n    }, () => {\n      fetch(\"\".concat(BACKEND_API_URL, \"/get/markers/\").concat(jwtToken), {\n        method: 'GET',\n        headers: {\n          'Accept': 'application/json',\n          'content-type': 'application/json'\n        }\n      }).then(response => {\n        return response.json();\n      }).then(jsonData => {\n        jsonData.map((marker, index) => {\n          let element = {\n            id: marker.id,\n            name: marker.name,\n            latitude: marker.latitude,\n            longitude: marker.longitude\n          };\n          this.setState({\n            markers: this.state.markers.concat(element)\n          });\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    });\n  }\n\n  onMapClick(t, map, coord) {\n    const latLng = coord.latLng;\n    const lat = latLng.lat();\n    const lng = latLng.lng();\n    this.setState({\n      latitude: lat,\n      longitude: lng\n    });\n    $(document).on('show.bs.modal', \"#modalCenter\", function (event) {\n      $('#name').trigger('focus');\n    });\n    $(\"#modalCenter\").modal('show');\n  }\n\n  setFinishMarker() {\n    this.setState({\n      isFinishMarker: true\n    });\n  }\n\n  setIsDeletedMarker() {\n    this.setState({\n      isDeletedMarker: true\n    });\n  }\n\n  setDeletedMarkerId(value) {\n    this.setState({\n      deletedMarkerId: value\n    }, () => {\n      let id = this.state.deletedMarkerId;\n      let index = 0;\n      this.state.markers.map((marker, index) => {\n        if (marker.id === id) {\n          this.setState({\n            markers: this.state.markers.splice(index, 1)\n          }, () => {\n            this.forceUpdate();\n          });\n        }\n\n        index++;\n      });\n    });\n  }\n\n  addMarkerToArray(object) {\n    this.setState({\n      markers: this.state.markers.concat(object)\n    });\n  }\n\n  render() {\n    const mapStyle = {\n      width: '100%',\n      height: '100%'\n    };\n    let loadingScreen = React.createElement(\"div\", {\n      className: \"d-flex justify-content-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"spinner-grow\",\n      role: \"status\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"sr-only\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, this.props.t(\"loading\"))));\n    let map = React.createElement(\"div\", {\n      className: \"google-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"story-header\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216\n      },\n      __self: this\n    }, this.props.t(\"googleMap.story\")), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"google-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"marker-table\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"table-responsive\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, React.createElement(\"table\", {\n      className: \"table table-striped table-hover\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223\n      },\n      __self: this\n    }, React.createElement(\"thead\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226\n      },\n      __self: this\n    }, React.createElement(\"b\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227\n      },\n      __self: this\n    }, \"#\")), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229\n      },\n      __self: this\n    }, this.props.t(\"googleMap.table.name\")), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232\n      },\n      __self: this\n    }, this.props.t(\"googleMap.table.latitude\")), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 235\n      },\n      __self: this\n    }, this.props.t(\"googleMap.table.longitude\")), React.createElement(\"th\", {\n      scope: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238\n      },\n      __self: this\n    }, this.props.t(\"googleMap.table.delete\")))), React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, this.showTableRows()))))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 250\n      },\n      __self: this\n    }, React.createElement(Map, {\n      google: this.props.google,\n      zoom: 5,\n      style: mapStyle,\n      initialCenter: {\n        lat: 48.023,\n        lng: 14.426\n      },\n      onClick: this.onMapClick,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    }, this.showMarkers(), React.createElement(InfoWindow, {\n      marker: this.state.activeMarker,\n      visible: this.state.showingInfoWindow,\n      onClose: this.onClose,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"alert alert-success\",\n      role: \"alert\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 264\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265\n      },\n      __self: this\n    }, this.state.selectedPlace.name)))), React.createElement(GoogleModal, {\n      latitude: this.state.latitude,\n      longitude: this.state.longitude,\n      setFinishMarker: this.setFinishMarker,\n      addMarkerToArray: this.addMarkerToArray,\n      fetchMarkers: this.fetchMarkers,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 269\n      },\n      __self: this\n    })));\n    let content = this.state.isLoading ? loadingScreen : map;\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 282\n      },\n      __self: this\n    }, content);\n  }\n\n}\n\nexport default compose(GoogleApiWrapper(props => ({\n  apiKey: 'AIzaSyBgb4kpatKEjsOGsxplxFyRfw1K_wGhLTo',\n  language: props.language\n})), withTranslation(\"common\"))(GoogleMap);","map":{"version":3,"sources":["/home/huber/Pulpit/Divelog/reactapp/src/components/googleMaps/GoogleMap.js"],"names":["React","Map","Marker","GoogleApiWrapper","InfoWindow","GoogleModal","$","DeleteButton","withTranslation","compose","AuthService","BACKEND_API_URL","GoogleMap","Component","constructor","props","showMarkers","state","markers","map","marker","index","name","lat","latitude","lng","longitude","onMarkerClick","showTableRows","i","id","setIsDeletedMarker","setDeletedMarkerId","fetchMarkers","e","setState","selectedPlace","activeMarker","showingInfoWindow","onClose","isLoading","isFinishMarker","isDeletedMarker","deletedMarkerId","Auth","onMapClick","bind","setFinishMarker","addMarkerToArray","componentDidMount","jwtToken","getRightSocialToken","fetch","method","headers","then","response","json","jsonData","console","log","length","element","concat","catch","err","t","coord","latLng","document","on","event","trigger","modal","value","splice","forceUpdate","object","render","mapStyle","width","height","loadingScreen","google","content","apiKey","language"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../../css/GoogleMap.css';\nimport { Map, Marker, GoogleApiWrapper, InfoWindow } from 'google-maps-react';\nimport GoogleModal from './GoogleModal';\nimport $ from 'jquery';\nimport DeleteButton from './DeleteButton';\nimport { withTranslation } from 'react-i18next';\nimport { compose } from 'redux';\nimport AuthService from '../../util/AuthService';\nimport { BACKEND_API_URL } from '../../actions/types';\n\nclass GoogleMap extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            isLoading: true,\n            showingInfoWindow: false,\n            activeMarker: {},\n            selectedPlace: {},\n            markers: [],\n            isFinishMarker: false,\n            latitude: '',\n            longitude: '',\n            isDeletedMarker: false,\n            deletedMarkerId: 0\n        }\n        this.Auth = new AuthService();\n\n        this.onMapClick = this.onMapClick.bind(this);\n        this.setFinishMarker = this.setFinishMarker.bind(this);\n        this.setIsDeletedMarker = this.setIsDeletedMarker.bind(this);\n        this.fetchMarkers = this.fetchMarkers.bind(this);\n        this.setDeletedMarkerId = this.setDeletedMarkerId.bind(this);\n        this.addMarkerToArray = this.addMarkerToArray.bind(this);\n    }\n\n    componentDidMount() {\n        this.setState({ isLoading: false });\n        \n        let jwtToken = this.Auth.getRightSocialToken();\n\n        fetch(`${BACKEND_API_URL}/get/markers/${jwtToken}`, {\n            method: 'GET',\n            headers: {\n                'Accept': 'application/json',\n                'Content-Type': 'application/json'\n            }\n        })\n        .then(response => { return response.json() })\n        .then(jsonData => {\n            console.log(jsonData);\n            if(jsonData.length !== 0) {\n                jsonData.map((marker, index) => {\n                    let element = {\n                        id: marker.id,\n                        name: marker.name,\n                        latitude: marker.latitude,\n                        longitude: marker.longitude\n                    }\n                    this.setState({\n                        markers: this.state.markers.concat(element)\n                    })\n                });\n            }\n        }).catch(err => {\n            console.log(err);\n        });\n    }\n\n    fetchMarkers() {\n        let jwtToken = this.Auth.getRightSocialToken();\n\n        this.setState({ markers: [] }, () => {\n            fetch(`${BACKEND_API_URL}/get/markers/${jwtToken}`, {\n                method: 'GET',\n                headers: {\n                    'Accept': 'application/json',\n                    'content-type': 'application/json'\n                }\n            })\n            .then(response => { return response.json() })\n            .then(jsonData => {\n                jsonData.map((marker, index) => {\n                    let element = {\n                        id: marker.id,\n                        name: marker.name,\n                        latitude: marker.latitude,\n                        longitude: marker.longitude\n                    }\n                    this.setState({\n                        markers: this.state.markers.concat(element)\n                    })\n                })\n            }).catch(err => {\n                console.log(err);\n            });\n        });\n    }\n\n    showMarkers = () => {\n        return this.state.markers.map((marker, index) => {\n            return (\n                <Marker \n                    key={index} \n                    name={marker.name}\n                    position={{ lat: marker.latitude, lng: marker.longitude }}\n                    onClick={this.onMarkerClick}\n                />\n            );\n        });\n    }\n\n    showTableRows = () => {\n        let i = 0;\n        return this.state.markers.map((marker, index) => {\n            return (\n                <tr key={index}>\n                    <th scope=\"row\">\n                        <b>{++i}</b>\n                    </th>\n                    <td>{marker.name}</td>\n                    <td>{marker.latitude}</td>\n                    <td>{marker.longitude}</td>\n                    <td>\n                        <DeleteButton \n                            id={marker.id}\n                            setIsDeletedMarker={this.setIsDeletedMarker}\n                            setDeletedMarkerId={this.setDeletedMarkerId}\n                            fetchMarkers={this.fetchMarkers}\n                        />\n                    </td>\n                </tr>\n            );\n        })\n    }\n\n    onMarkerClick = (props, marker, e) => {\n        this.setState({\n            selectedPlace: props,\n            activeMarker: marker,\n            showingInfoWindow: true\n        });\n    }\n\n    onClose = props => {\n        if(this.state.showingInfoWindow) {\n            this.setState({\n                showingInfoWindow: false,\n                activeMarker: null\n            });\n        }\n    };\n\n    onMapClick(t, map, coord) {\n        const { latLng } = coord;\n        const lat = latLng.lat();\n        const lng = latLng.lng();\n\n        this.setState({ \n            latitude: lat,\n            longitude: lng\n        });\n\n        $(document).on('show.bs.modal', \"#modalCenter\", function (event) {\n            $('#name').trigger('focus');\n        });\n        $(\"#modalCenter\").modal('show');\n    }\n\n    setFinishMarker() {\n        this.setState({ isFinishMarker: true });\n    }\n\n    setIsDeletedMarker() {\n        this.setState({ isDeletedMarker: true });\n    }\n\n    setDeletedMarkerId(value) {\n        this.setState({ deletedMarkerId: value }, () => {\n            let id = this.state.deletedMarkerId;\n            let index = 0;\n            this.state.markers.map((marker, index) => {\n                if(marker.id === id) {\n                    this.setState({ markers: this.state.markers.splice(index, 1) }, () => {\n                        this.forceUpdate();\n                    });\n                }\n                index++;\n            });\n        });\n    }\n\n    addMarkerToArray(object) {\n        this.setState({ markers: this.state.markers.concat(object) });\n    }\n\n    render() {\n        const mapStyle = {\n            width: '100%',\n            height: '100%',\n        }\n\n        let loadingScreen = (\n            <div className=\"d-flex justify-content-center\">\n                <div className=\"spinner-grow\" role=\"status\">\n                    <span className=\"sr-only\">\n                        {this.props.t(\"loading\")}\n                    </span>\n                </div>\n            </div>\n        )\n\n        let map = (\n            <div className=\"google-container\">\n                <div className=\"story-header\"> \n                    {this.props.t(\"googleMap.story\")}\n                </div>\n                <br />\n                <div className=\"google-center\">\n                    <div className=\"marker-table\">\n                        <div className=\"table-responsive\">\n                            <table className=\"table table-striped table-hover\">\n                                <thead>\n                                    <tr>\n                                        <th scope=\"col\">\n                                            <b>#</b>\n                                        </th>\n                                        <th scope=\"col\">\n                                            {this.props.t(\"googleMap.table.name\")}\n                                        </th>\n                                        <th scope=\"col\">\n                                            {this.props.t(\"googleMap.table.latitude\")}\n                                        </th>\n                                        <th scope=\"col\">\n                                            {this.props.t(\"googleMap.table.longitude\")}\n                                        </th>\n                                        <th scope=\"col\">\n                                            {this.props.t(\"googleMap.table.delete\")}\n                                        </th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    { this.showTableRows() }\n                                </tbody>\n                            </table>\n                        </div>\n                    </div>\n                </div>\n                <div>\n                    <Map\n                        google={this.props.google}\n                        zoom={5}\n                        style={mapStyle}\n                        initialCenter={{ lat: 48.023, lng: 14.426}}\n                        onClick={this.onMapClick}\n                    >\n                        { this.showMarkers() }\n                        <InfoWindow\n                            marker={this.state.activeMarker}\n                            visible={this.state.showingInfoWindow}\n                            onClose={this.onClose}\n                        >\n                        <div className=\"alert alert-success\" role=\"alert\">\n                            <h4>{this.state.selectedPlace.name}</h4>\n                        </div>\n                        </InfoWindow>\n                    </Map>\n                    <GoogleModal \n                        latitude={this.state.latitude}\n                        longitude={this.state.longitude}\n                        setFinishMarker={this.setFinishMarker}\n                        addMarkerToArray={this.addMarkerToArray}\n                        fetchMarkers={this.fetchMarkers}\n                    />\n                </div>\n            </div>     \n        )\n        let content = this.state.isLoading ? loadingScreen : map;\n\n        return (\n            <div>\n                { content }\n            </div>\n        );\n    }\n}\n\nexport default compose(\n    GoogleApiWrapper(\n    (props) => ({\n      apiKey: 'AIzaSyBgb4kpatKEjsOGsxplxFyRfw1K_wGhLTo',\n      language: props.language,\n    }\n  )),\n    withTranslation(\"common\")\n  )(GoogleMap);"]},"metadata":{},"sourceType":"module"}