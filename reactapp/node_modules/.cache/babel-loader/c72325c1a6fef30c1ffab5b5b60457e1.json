{"ast":null,"code":"var _jsxFileName = \"/home/huber/Pulpit/Divelog/reactapp/src/util/withAuth.js\";\nimport React from 'react';\nimport AuthService from './AuthService'; // export default function withAuth(AuthComponent) {\n\nexport default function withAuth(AuthComponent, props) {\n  const Auth = new AuthService();\n  let customAuthComponent = false;\n\n  class AuthWrapped extends React.Component {\n    constructor(props) {\n      super(props);\n      this.state = {\n        isRedirectToLoginPage: true\n      };\n    }\n\n    setRedirectForTwitterExplore(props, url) {\n      if (props.hasOwnProperty(\"twitterExploreForCategories\")) {\n        if (props.twitterExploreForCategories) {\n          this.props.history.replace(url);\n        }\n      }\n\n      if (props.hasOwnProperty(\"twitterExplore\")) {\n        if (props.twitterExplore) {\n          this.props.history.replace(url);\n        }\n      }\n    }\n\n    componentWillMount() {\n      console.log(\"Hubert Strumiński\");\n      console.log(props);\n      customAuthComponent = true;\n\n      if (!Auth.loggedIn()) {\n        console.log(\"!Auth.loggedIn()\");\n        this.props.history.replace(\"/login\");\n      } else {\n        console.log(\"before retrieving JwtToken\");\n        let twitterJwtToken = Auth.getTwitterToken();\n        let facebookJwtToken = Auth.getToken();\n        console.log(twitterJwtToken);\n        console.log(facebookJwtToken);\n\n        try {\n          if (twitterJwtToken) {\n            if (props !== undefined) {\n              if (this.props.location.pathname === \"/twitter/explore\") {\n                customAuthComponent && this.setRedirectForTwitterExplore(props, \"/twitter/explore\");\n              }\n\n              if (this.props.location.pathname === \"/twitter/home\") {\n                customAuthComponent && this.props.history.replace(\"/twitter/home\");\n              }\n            } else {\n              fetch(\"/twitter/login/validate/token/\".concat(this.props.match.params.jwtToken), {\n                method: 'GET',\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              }).then(response => {\n                if (response.status === 200) {\n                  localStorage.setItem(\"twitterJwtToken\", this.props.match.params.jwtToken);\n                  this.setState({\n                    isRedirectToLoginPage: false\n                  });\n                } else {\n                  this.props.history.replace(\"/login\");\n                }\n              });\n              customAuthComponent && this.props.history.replace(\"/twitter\");\n            }\n          }\n\n          if (facebookJwtToken) {\n            customAuthComponent && this.props.history.replace(\"/dashboard\");\n          }\n        } catch (err) {\n          if (twitterJwtToken) {\n            Auth.logoutTwitter();\n          }\n\n          if (facebookJwtToken) {\n            Auth.logout();\n          }\n\n          console.log(\"/login\");\n          this.props.history.replace(\"/login\");\n        }\n      }\n    }\n\n    componentWillUnmount() {\n      customAuthComponent = false;\n    }\n\n    render() {\n      let isRedirectToLoginPage = this.state.isRedirectToLoginPage;\n\n      if (!isRedirectToLoginPage) {\n        customAuthComponent && React.createElement(AuthComponent, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 97\n          },\n          __self: this\n        });\n      } else {}\n\n      if (Auth.loggedIn()) {\n        return customAuthComponent && React.createElement(AuthComponent, {\n          history: this.props.history,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 103\n          },\n          __self: this\n        });\n      } else {\n        return null;\n      }\n    }\n\n  }\n\n  return AuthWrapped;\n}","map":{"version":3,"sources":["/home/huber/Pulpit/Divelog/reactapp/src/util/withAuth.js"],"names":["React","AuthService","withAuth","AuthComponent","props","Auth","customAuthComponent","AuthWrapped","Component","constructor","state","isRedirectToLoginPage","setRedirectForTwitterExplore","url","hasOwnProperty","twitterExploreForCategories","history","replace","twitterExplore","componentWillMount","console","log","loggedIn","twitterJwtToken","getTwitterToken","facebookJwtToken","getToken","undefined","location","pathname","fetch","match","params","jwtToken","method","headers","then","response","status","localStorage","setItem","setState","err","logoutTwitter","logout","componentWillUnmount","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport AuthService from './AuthService';\n\n// export default function withAuth(AuthComponent) {\nexport default function withAuth(AuthComponent, props) {\n    const Auth =  new AuthService();\n    let customAuthComponent = false;\n\n    class AuthWrapped extends React.Component {\n        constructor(props) {\n            super(props);\n\n            this.state = {\n                isRedirectToLoginPage: true\n            }\n        }\n\n        setRedirectForTwitterExplore(props, url) {\n            if(props.hasOwnProperty(\"twitterExploreForCategories\")) {\n                if(props.twitterExploreForCategories) {\n                    this.props.history.replace(url);\n                }\n            }\n\n            if(props.hasOwnProperty(\"twitterExplore\")) {\n                if(props.twitterExplore) {\n                    this.props.history.replace(url);\n                }\n            }\n        }\n\n        componentWillMount() {\n            console.log(\"Hubert Strumiński\");\n            console.log(props);\n            customAuthComponent = true;\n\n            if(!Auth.loggedIn()) {\n                console.log(\"!Auth.loggedIn()\");\n                this.props.history.replace(\"/login\");\n            } else {\n                console.log(\"before retrieving JwtToken\");\n                let twitterJwtToken = Auth.getTwitterToken();\n                let facebookJwtToken = Auth.getToken();\n                console.log(twitterJwtToken);\n                console.log(facebookJwtToken);\n                try {\n                    if(twitterJwtToken) {\n                        if(props !== undefined) {\n                            if(this.props.location.pathname === \"/twitter/explore\") {\n                                customAuthComponent && this.setRedirectForTwitterExplore(props, \"/twitter/explore\");\n                            }\n                            if(this.props.location.pathname === \"/twitter/home\") {\n                                customAuthComponent && this.props.history.replace(\"/twitter/home\");\n                            }\n                        } else {\n                            fetch(`/twitter/login/validate/token/${this.props.match.params.jwtToken}`, {\n                                method: 'GET',\n                                headers: {\n                                    'Content-Type': 'application/json'\n                                }\n                            }).then(response => {\n                                if(response.status === 200) {\n                                    localStorage.setItem(\"twitterJwtToken\", this.props.match.params.jwtToken);\n                                    this.setState({ isRedirectToLoginPage: false });\n                                } else {\n                                    this.props.history.replace(\"/login\");\n                                }\n                            });\n                            customAuthComponent && this.props.history.replace(\"/twitter\");\n                        }\n                    }\n\n                    if(facebookJwtToken) {\n                        customAuthComponent && this.props.history.replace(\"/dashboard\");\n                    }\n                } catch(err) {\n                    if(twitterJwtToken) {\n                        Auth.logoutTwitter();\n                    }\n                    if(facebookJwtToken) {\n                        Auth.logout();\n                    }\n                    console.log(\"/login\");\n                    this.props.history.replace(\"/login\");\n                }\n            }\n        }\n\n        componentWillUnmount() {\n            customAuthComponent = false;\n        }\n\n        render() {\n            let isRedirectToLoginPage = this.state.isRedirectToLoginPage;\n\n            if(!isRedirectToLoginPage) {\n                customAuthComponent && <AuthComponent />\n            } else {\n                \n            }\n            if(Auth.loggedIn()) {\n                return (\n                    customAuthComponent && <AuthComponent history={this.props.history} />\n                );\n            } else {\n                return null;\n            }\n        }\n    }\n    return AuthWrapped;\n}"]},"metadata":{},"sourceType":"module"}