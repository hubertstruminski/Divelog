"use strict";
/*
 * Copyright (c) 2018 by Filestack
 * Some rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
/* istanbul ignore file */
var nock = require("nock");
var zlib = require("zlib");
var stream_1 = require("stream");
var types_1 = require("../types");
var token_1 = require("../token");
var error_1 = require("../error");
exports.adaptersHttpAbstract = function (adapter, adapterName) {
    describe("Request/Adapters/" + adapterName, function () {
        var scope;
        var url = 'https://somewrongdom.moc';
        beforeEach(function () {
            nock.cleanAll();
            scope = null;
        });
        beforeEach(function () {
            scope = nock(url).defaultReplyHeaders({
                'access-control-allow-origin': function (req) { return req.headers['origin']; },
                'access-control-allow-methods': function (req) { return req.headers['access-control-request-method']; },
                'access-control-allow-headers': function (req) { return req.headers['access-control-request-headers']; },
            });
            if (adapterName === 'xhr') {
                scope.options(/.*/).reply(200);
            }
        });
        describe('request basic', function () {
            it('should make correct request (https)', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var options, requestAdapter, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                            };
                            scope.get('/').reply(200, 'ok', { 'Content-Type': 'text/plain' });
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 1:
                            res = _a.sent();
                            expect(res.status).toEqual(200);
                            expect(res.data).toEqual('ok');
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should make correct request (http)', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var httpUrl, scopeHttp, options, requestAdapter, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            httpUrl = url.replace('https', 'http');
                            scopeHttp = nock(httpUrl).defaultReplyHeaders({
                                'access-control-allow-origin': function (req) { return req.headers['origin']; },
                                'access-control-allow-methods': function (req) { return req.headers['access-control-request-method']; },
                                'access-control-allow-headers': function (req) { return req.headers['access-control-request-headers']; },
                            });
                            if (adapterName === 'xhr') {
                                scopeHttp.options(/.*/).reply(200);
                            }
                            options = {
                                url: httpUrl,
                                method: types_1.FsHttpMethod.GET,
                            };
                            scopeHttp.get('/').reply(200, 'ok', { 'Content-Type': 'text/plain' });
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 1:
                            res = _a.sent();
                            expect(res.status).toEqual(200);
                            expect(res.data).toEqual('ok');
                            scopeHttp.done();
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should add https protocol if no protocol is provided', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var options, requestAdapter, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            options = {
                                url: url.replace('https://', ''),
                                method: types_1.FsHttpMethod.GET,
                            };
                            scope.get('/').reply(200, 'ok', { 'Content-Type': 'text/plain' });
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 1:
                            res = _a.sent();
                            expect(res.status).toEqual(200);
                            expect(res.data).toEqual('ok');
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should handle string as data param', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var msg, mock, options, requestAdapter, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            msg = 'Some test stream data';
                            mock = jest
                                .fn()
                                .mockName('bufferData')
                                .mockReturnValue(msg);
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.POST,
                                data: msg,
                            };
                            scope.post('/').reply(200, function (_, data) {
                                return mock(data);
                            }, { 'Content-Type': 'text/plain' });
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 1:
                            res = _a.sent();
                            expect(res.status).toEqual(200);
                            expect(res.data).toEqual(msg);
                            expect(mock).toHaveBeenLastCalledWith(msg);
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
            // gzip support is handled by the browser on xhr side
            if (adapterName !== 'xhr') {
                it('should handle deflate response', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                    var options, data, requestAdapter, res;
                    return tslib_1.__generator(this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                options = {
                                    url: url,
                                    method: types_1.FsHttpMethod.GET,
                                };
                                data = zlib.gzipSync(Buffer.from('ok', 'utf-8'));
                                scope.get('/').reply(200, data, { 'Content-encoding': 'gzip, deflate', 'Content-type': 'text/plain' });
                                requestAdapter = new adapter();
                                return [4 /*yield*/, requestAdapter.request(options)];
                            case 1:
                                res = _a.sent();
                                expect(res.status).toEqual(200);
                                expect(res.data).toEqual('ok');
                                scope.done();
                                return [2 /*return*/];
                        }
                    });
                }); });
                it('should handle 204 gzip request', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                    var options, requestAdapter, res;
                    return tslib_1.__generator(this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                options = {
                                    url: url,
                                    method: types_1.FsHttpMethod.GET,
                                };
                                scope.get('/').reply(204, '', { 'Content-encoding': 'gzip, deflate', 'Content-type': 'text/plain' });
                                requestAdapter = new adapter();
                                return [4 /*yield*/, requestAdapter.request(options)];
                            case 1:
                                res = _a.sent();
                                expect(res.status).toEqual(204);
                                expect(res.data).toEqual(null);
                                scope.done();
                                return [2 /*return*/];
                        }
                    });
                }); });
                it('should handle Buffer as data param', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                    var msg, mock, options, requestAdapter, res;
                    return tslib_1.__generator(this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                msg = 'Some test stream data';
                                mock = jest
                                    .fn()
                                    .mockName('bufferData')
                                    .mockReturnValue('ok');
                                options = {
                                    url: url,
                                    method: types_1.FsHttpMethod.POST,
                                    data: Buffer.from(msg, 'utf-8'),
                                };
                                scope.post('/').reply(200, function (_, data) {
                                    return mock(data);
                                }, { 'Content-type': 'text/plain' });
                                requestAdapter = new adapter();
                                return [4 /*yield*/, requestAdapter.request(options)];
                            case 1:
                                res = _a.sent();
                                expect(res.status).toEqual(200);
                                expect(mock).toHaveBeenLastCalledWith(msg);
                                scope.done();
                                return [2 /*return*/];
                        }
                    });
                }); });
                it('should throw error when data type is unsupported', function () {
                    var options = {
                        url: url,
                        method: types_1.FsHttpMethod.POST,
                        data: stream_1.Readable.from(['test']),
                    };
                    var requestAdapter = new adapter();
                    return expect(requestAdapter.request(options)).rejects.toEqual(expect.any(error_1.FsRequestError));
                });
            }
            it('should make request with auth', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var auth, options, requestAdapter, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            auth = {
                                username: 'test',
                                password: 'test',
                            };
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                                auth: auth,
                            };
                            scope.options('/').reply(200, 'ok');
                            scope
                                .get('/')
                                .basicAuth({ user: auth.username, pass: auth.password })
                                .reply(200, 'ok', { 'access-control-allow-origin': '*' });
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 1:
                            res = _a.sent();
                            expect(res.status).toEqual(200);
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should throw an error on empty username', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var auth, options, requestAdapter;
                return tslib_1.__generator(this, function (_a) {
                    auth = {
                        username: null,
                        password: 'test',
                    };
                    options = {
                        url: url,
                        method: types_1.FsHttpMethod.GET,
                        auth: auth,
                    };
                    requestAdapter = new adapter();
                    return [2 /*return*/, expect(requestAdapter.request(options)).rejects.toEqual(expect.any(error_1.FsRequestError))];
                });
            }); });
            it('should throw an error on empty password', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var auth, options, requestAdapter;
                return tslib_1.__generator(this, function (_a) {
                    auth = {
                        username: 'test',
                        password: null,
                    };
                    options = {
                        url: url,
                        method: types_1.FsHttpMethod.GET,
                        auth: auth,
                    };
                    requestAdapter = new adapter();
                    return [2 /*return*/, expect(requestAdapter.request(options)).rejects.toEqual(expect.any(error_1.FsRequestError))];
                });
            }); });
            it('should overwrite auth header if auth data is provided', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var auth, options, requestAdapter, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            auth = {
                                username: 'test',
                                password: 'test',
                            };
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                                auth: auth,
                                headers: {
                                    Authorization: 'test123',
                                },
                            };
                            scope.options('/').reply(200, 'ok');
                            scope
                                .get('/')
                                .basicAuth({ user: auth.username, pass: auth.password })
                                .reply(200, 'ok');
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 1:
                            res = _a.sent();
                            expect(res.status).toEqual(200);
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should contain default headers', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var mock, options, requestAdapter, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            mock = jest
                                .fn()
                                .mockName('default/headers')
                                .mockReturnValue('ok');
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                            };
                            scope.get('/').reply(200, function (_, data) {
                                return mock(this.req.headers);
                            });
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 1:
                            res = _a.sent();
                            expect(res.status).toEqual(200);
                            expect(mock).toHaveBeenCalledWith(expect.objectContaining({ 'filestack-source': expect.any(String), 'filestack-trace-id': expect.any(String), 'filestack-trace-span': expect.any(String) }));
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should omit default headers', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var mock, options, requestAdapter, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            mock = jest
                                .fn()
                                .mockName('default/headers')
                                .mockReturnValue('ok');
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                                filestackHeaders: false,
                            };
                            scope.get('/').reply(200, function (_, data) {
                                return mock(this.req.headers);
                            });
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 1:
                            res = _a.sent();
                            expect(res.status).toEqual(200);
                            expect(mock).toHaveBeenCalledWith(expect.not.objectContaining({ 'filestack-source': expect.any(String), 'filestack-trace-id': expect.any(String), 'filestack-trace-span': expect.any(String) }));
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should skip undefined headers', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var mock, options, requestAdapter, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            mock = jest
                                .fn()
                                .mockName('undefined/headers')
                                .mockReturnValue('ok');
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                                headers: {
                                    test: undefined,
                                },
                            };
                            scope.get('/').reply(200, function (_, data) {
                                return mock(this.req.headers);
                            });
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 1:
                            res = _a.sent();
                            expect(res.status).toEqual(200);
                            expect(mock).toHaveBeenCalledWith(expect.not.objectContaining({ test: undefined }));
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
        });
        describe('redirects ', function () {
            // xhr redirects are handled by the browser
            if (adapterName !== 'xhr') {
                it('should follow 302 redirect', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                    var options, response, requestAdapter, res;
                    return tslib_1.__generator(this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                options = {
                                    url: url,
                                    method: types_1.FsHttpMethod.GET,
                                };
                                response = { test: 123 };
                                scope.get('/').reply(302, 'ok', {
                                    location: url + "/resp",
                                });
                                scope.get('/resp').reply(200, response, {
                                    'Content-type': 'application/json',
                                });
                                requestAdapter = new adapter();
                                return [4 /*yield*/, requestAdapter.request(options)];
                            case 1:
                                res = _a.sent();
                                expect(res.status).toEqual(200);
                                expect(res.data).toEqual(response);
                                scope.done();
                                return [2 /*return*/];
                        }
                    });
                }); });
                it('should throw error when no location is provided', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                    var options, requestAdapter, err_1;
                    return tslib_1.__generator(this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                options = {
                                    url: url,
                                    method: types_1.FsHttpMethod.GET,
                                };
                                scope.get('/').reply(302, 'ok', { location: '' });
                                _a.label = 1;
                            case 1:
                                _a.trys.push([1, 3, , 4]);
                                requestAdapter = new adapter();
                                return [4 /*yield*/, requestAdapter.request(options)];
                            case 2:
                                _a.sent();
                                // return error in try will not emit error
                                expect(false).toEqual(true);
                                return [3 /*break*/, 4];
                            case 3:
                                err_1 = _a.sent();
                                expect(err_1).toEqual(expect.any(error_1.FsRequestError));
                                expect(err_1.code).toEqual(error_1.FsRequestErrorCode.REDIRECT);
                                return [3 /*break*/, 4];
                            case 4:
                                scope.done();
                                return [2 /*return*/];
                        }
                    });
                }); });
                it('should throw error (REDIRECT) on max redirects', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                    var options, requestAdapter, err_2;
                    return tslib_1.__generator(this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                options = {
                                    url: url,
                                    method: types_1.FsHttpMethod.GET,
                                };
                                if (adapterName === 'xhr') {
                                    scope.options('/').reply(200, 'ok');
                                }
                                scope
                                    .get('/')
                                    .reply(302, 'ok', {
                                    location: url + "/a",
                                })
                                    .get('/a')
                                    .reply(301, 'ok', {
                                    location: url + "/b",
                                })
                                    .get('/b')
                                    .reply(302, 'ok', {
                                    location: url + "/c",
                                })
                                    .get('/c')
                                    .reply(301, 'ok', {
                                    location: url + "/d",
                                })
                                    .get('/d')
                                    .reply(302, 'ok', {
                                    location: url + "/e",
                                })
                                    .get('/e')
                                    .reply(301, 'ok', {
                                    location: url + "/f",
                                })
                                    .get('/f')
                                    .reply(302, 'ok', {
                                    location: url + "/g",
                                })
                                    .get('/g')
                                    .reply(301, 'ok', {
                                    location: url + "/h",
                                })
                                    .get('/h')
                                    .reply(302, 'ok', {
                                    location: url + "/i",
                                })
                                    .get('/i')
                                    .reply(301, 'ok', {
                                    location: url + "/j",
                                })
                                    .get('/j')
                                    .reply(302, 'ok', {
                                    location: url + "/k",
                                });
                                _a.label = 1;
                            case 1:
                                _a.trys.push([1, 3, , 4]);
                                requestAdapter = new adapter();
                                return [4 /*yield*/, requestAdapter.request(options)];
                            case 2:
                                _a.sent();
                                // return error in try will not emit error
                                expect(false).toEqual(true);
                                return [3 /*break*/, 4];
                            case 3:
                                err_2 = _a.sent();
                                expect(err_2).toEqual(expect.any(error_1.FsRequestError));
                                expect(err_2.code).toEqual(error_1.FsRequestErrorCode.REDIRECT);
                                return [3 /*break*/, 4];
                            case 4:
                                scope.done();
                                return [2 /*return*/];
                        }
                    });
                }); });
                it('should throw error on redirect loop', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                    var options, requestAdapter, err_3;
                    return tslib_1.__generator(this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                options = {
                                    url: url,
                                    method: types_1.FsHttpMethod.GET,
                                };
                                scope
                                    .get('/')
                                    .reply(302, 'ok', { location: url + "/a" })
                                    .get('/a')
                                    .reply(302, 'ok', { location: url + "/a" })
                                    .get('/a')
                                    .reply(200, 'ok');
                                _a.label = 1;
                            case 1:
                                _a.trys.push([1, 3, , 4]);
                                requestAdapter = new adapter();
                                return [4 /*yield*/, requestAdapter.request(options)];
                            case 2:
                                _a.sent();
                                // return error in try will not emit error
                                expect(false).toEqual(true);
                                return [3 /*break*/, 4];
                            case 3:
                                err_3 = _a.sent();
                                expect(err_3).toEqual(expect.any(error_1.FsRequestError));
                                expect(err_3.code).toEqual(error_1.FsRequestErrorCode.REDIRECT);
                                return [3 /*break*/, 4];
                            case 4: return [2 /*return*/];
                        }
                    });
                }); });
            }
        });
        if (adapterName === 'xhr') {
            describe('request form', function () {
                it('Should send form data', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                    var form, options, resp, requestAdapter, res;
                    return tslib_1.__generator(this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                form = new FormData();
                                options = {
                                    url: url,
                                    method: types_1.FsHttpMethod.POST,
                                    data: form,
                                };
                                resp = { form: 'ok' };
                                scope.post('/').reply(200, resp, { 'Content-type': 'application/json' });
                                requestAdapter = new adapter();
                                return [4 /*yield*/, requestAdapter.request(options)];
                            case 1:
                                res = _a.sent();
                                expect(res.status).toEqual(200);
                                expect(res.data).toEqual(resp);
                                scope.done();
                                return [2 /*return*/];
                        }
                    });
                }); });
            });
        }
        describe('4xx and 5xx errors handling', function () {
            it('should handle 4xx response', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var options, errorResp, requestAdapter, err_4;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                            };
                            errorResp = { test: 123 };
                            scope.get('/').reply(404, errorResp, {
                                'Content-type': 'application/json',
                            });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 2:
                            _a.sent();
                            expect(false).toEqual(true);
                            return [3 /*break*/, 4];
                        case 3:
                            err_4 = _a.sent();
                            expect(err_4).toEqual(expect.any(error_1.FsRequestError));
                            expect(err_4.code).toEqual(error_1.FsRequestErrorCode.REQUEST);
                            expect(err_4.response.status).toEqual(404);
                            expect(err_4.response.data).toEqual(errorResp);
                            return [3 /*break*/, 4];
                        case 4:
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
            it('should handle 5xx response', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var options, errorResp, requestAdapter, err_5;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                            };
                            errorResp = { test: 123 };
                            scope.get('/').reply(501, errorResp, {
                                'Content-type': 'application/json',
                            });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 2:
                            _a.sent();
                            expect(false).toEqual(true);
                            return [3 /*break*/, 4];
                        case 3:
                            err_5 = _a.sent();
                            expect(err_5).toEqual(expect.any(error_1.FsRequestError));
                            expect(err_5.code).toEqual(error_1.FsRequestErrorCode.SERVER);
                            expect(err_5.response.status).toEqual(501);
                            expect(err_5.response.data).toEqual(errorResp);
                            return [3 /*break*/, 4];
                        case 4:
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
        });
        if (adapterName === 'xhr') {
            describe('progress event', function () {
                it('should handle upload progress', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                    var progressSpy, buf, options, requestAdapter, res;
                    return tslib_1.__generator(this, function (_a) {
                        switch (_a.label) {
                            case 0:
                                progressSpy = jest
                                    .fn()
                                    .mockName('bufferData')
                                    .mockReturnThis();
                                buf = Buffer.alloc(1024);
                                buf.fill('a');
                                options = {
                                    url: url + "/progress",
                                    method: types_1.FsHttpMethod.POST,
                                    onProgress: progressSpy,
                                    data: buf,
                                };
                                scope.options('/progress').reply(200, 'ok', {
                                    'Content-type': 'application/json',
                                });
                                scope.post('/progress').reply(200, 'ok', {
                                    'Content-type': 'application/json',
                                });
                                requestAdapter = new adapter();
                                return [4 /*yield*/, requestAdapter.request(options)];
                            case 1:
                                res = _a.sent();
                                // for jsdom we cannot check progress event correctly
                                expect(progressSpy).toHaveBeenCalled();
                                return [2 /*return*/];
                        }
                    });
                }); });
            });
        }
        describe('cancelToken', function () {
            it('Should throw abort request when token will be called', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var token, options, requestAdapter, err_6;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            token = new token_1.FsCancelToken();
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                                cancelToken: token,
                            };
                            scope
                                .get('/')
                                .delay(2000)
                                .reply(200, 'ok', {
                                'Content-type': 'application/json',
                            });
                            setTimeout(function () {
                                token.cancel();
                            }, 100);
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 2:
                            _a.sent();
                            // return error in try will not emit error
                            expect(false).toEqual(true);
                            return [3 /*break*/, 4];
                        case 3:
                            err_6 = _a.sent();
                            expect(err_6).toEqual(expect.any(error_1.FsRequestError));
                            expect(err_6.code).toEqual(error_1.FsRequestErrorCode.ABORTED);
                            return [3 /*break*/, 4];
                        case 4: return [2 /*return*/];
                    }
                });
            }); });
            it('Should not throw undefined error when cancel token will be called after request finished', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var token, options, requestAdapter, res;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            token = new token_1.FsCancelToken();
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                                cancelToken: token,
                            };
                            scope.get('/').reply(200, 'ok', {
                                'Content-type': 'text/plain',
                            });
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 1:
                            res = _a.sent();
                            token.cancel();
                            expect(res.status).toEqual(200);
                            expect(res.data).toEqual('ok');
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
        });
        describe('Network errors', function () {
            it('should throw an error on domain not found', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var options, requestAdapter;
                return tslib_1.__generator(this, function (_a) {
                    options = {
                        url: 'https://some-badd-url.er',
                        method: types_1.FsHttpMethod.GET,
                    };
                    requestAdapter = new adapter();
                    return [2 /*return*/, expect(requestAdapter.request(options)).rejects.toEqual(expect.any(error_1.FsRequestError))];
                });
            }); });
            it('Should throw an FilestackError on socket abort with FsRequestErrorCode.TIMEOUTED code', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var options, requestAdapter, err_7;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                                timeout: 50,
                            };
                            scope
                                .get('/')
                                .delay(2000)
                                .reply(200, 'ok', {
                                'Content-type': 'application/json',
                            });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 2:
                            _a.sent();
                            // return error in try will not emit error
                            expect(false).toEqual(true);
                            return [3 /*break*/, 4];
                        case 3:
                            err_7 = _a.sent();
                            expect(err_7).toEqual(expect.any(error_1.FsRequestError));
                            expect(err_7.code).toEqual(error_1.FsRequestErrorCode.TIMEOUT);
                            return [3 /*break*/, 4];
                        case 4:
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
            it('Should throw an FilestackError on response ECONNREFUSED error with FsRequestErrorCode.NETWORK code', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var options, requestAdapter, err_8;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                            };
                            scope.get('/').replyWithError({ code: 'ECONNREFUSED' });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 2:
                            _a.sent();
                            // return error in try will not emit error
                            expect(false).toEqual(true);
                            return [3 /*break*/, 4];
                        case 3:
                            err_8 = _a.sent();
                            expect(err_8).toEqual(expect.any(error_1.FsRequestError));
                            expect(err_8.code).toEqual(error_1.FsRequestErrorCode.NETWORK);
                            return [3 /*break*/, 4];
                        case 4:
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
            it('Should throw an FilestackError on response ECONNRESET error with FsRequestErrorCode.NETWORK code', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var options, requestAdapter, err_9;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                            };
                            scope.get('/').replyWithError({ code: 'ECONNRESET' });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 2:
                            _a.sent();
                            // return error in try will not emit error
                            expect(false).toEqual(true);
                            return [3 /*break*/, 4];
                        case 3:
                            err_9 = _a.sent();
                            expect(err_9).toEqual(expect.any(error_1.FsRequestError));
                            expect(err_9.code).toEqual(error_1.FsRequestErrorCode.NETWORK);
                            return [3 /*break*/, 4];
                        case 4:
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
            it('Should throw an FilestackError on response ENOTFOUND error with FsRequestErrorCode.NETWORK code', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var options, requestAdapter, err_10;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                            };
                            scope.get('/').replyWithError({ code: 'ENOTFOUND' });
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 2:
                            _a.sent();
                            // return error in try will not emit error
                            expect(false).toEqual(true);
                            return [3 /*break*/, 4];
                        case 3:
                            err_10 = _a.sent();
                            expect(err_10).toEqual(expect.any(error_1.FsRequestError));
                            expect(err_10.code).toEqual(error_1.FsRequestErrorCode.NETWORK);
                            return [3 /*break*/, 4];
                        case 4:
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
            it('Should abort request on timeout', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
                var options, requestAdapter, err_11;
                return tslib_1.__generator(this, function (_a) {
                    switch (_a.label) {
                        case 0:
                            options = {
                                url: url,
                                method: types_1.FsHttpMethod.GET,
                                timeout: 1000,
                            };
                            scope
                                .get('/')
                                .delay(2000)
                                .reply(200, 'ok');
                            _a.label = 1;
                        case 1:
                            _a.trys.push([1, 3, , 4]);
                            requestAdapter = new adapter();
                            return [4 /*yield*/, requestAdapter.request(options)];
                        case 2:
                            _a.sent();
                            // return error in try will not emit error
                            expect(false).toEqual(true);
                            return [3 /*break*/, 4];
                        case 3:
                            err_11 = _a.sent();
                            expect(err_11).toEqual(expect.any(error_1.FsRequestError));
                            expect(err_11.code).toEqual(error_1.FsRequestErrorCode.TIMEOUT);
                            return [3 /*break*/, 4];
                        case 4:
                            scope.done();
                            return [2 /*return*/];
                    }
                });
            }); });
        });
    });
};

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9saWIvcmVxdWVzdC9hZGFwdGVycy9hZGFwdGVycy5hYnN0cmFjdHNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7Ozs7Ozs7Ozs7R0FlRzs7O0FBRUgsMEJBQTBCO0FBQzFCLDJCQUE2QjtBQUM3QiwyQkFBNkI7QUFDN0IsaUNBQWtDO0FBQ2xDLGtDQUEwRDtBQUMxRCxrQ0FBeUM7QUFDekMsa0NBQThEO0FBRWpELFFBQUEsb0JBQW9CLEdBQUcsVUFBQyxPQUFZLEVBQUUsV0FBbUI7SUFDcEUsUUFBUSxDQUFDLHNCQUFvQixXQUFhLEVBQUU7UUFDMUMsSUFBSSxLQUFLLENBQUM7UUFDVixJQUFNLEdBQUcsR0FBRywwQkFBMEIsQ0FBQztRQUV2QyxVQUFVLENBQUM7WUFDVCxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDaEIsS0FBSyxHQUFHLElBQUksQ0FBQztRQUNmLENBQUMsQ0FBQyxDQUFDO1FBRUgsVUFBVSxDQUFDO1lBQ1QsS0FBSyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQztnQkFDcEMsNkJBQTZCLEVBQUUsVUFBQSxHQUFHLElBQUksT0FBQSxHQUFHLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxFQUFyQixDQUFxQjtnQkFDM0QsOEJBQThCLEVBQUUsVUFBQSxHQUFHLElBQUksT0FBQSxHQUFHLENBQUMsT0FBTyxDQUFDLCtCQUErQixDQUFDLEVBQTVDLENBQTRDO2dCQUNuRiw4QkFBOEIsRUFBRSxVQUFBLEdBQUcsSUFBSSxPQUFBLEdBQUcsQ0FBQyxPQUFPLENBQUMsZ0NBQWdDLENBQUMsRUFBN0MsQ0FBNkM7YUFDckYsQ0FBQyxDQUFDO1lBRUgsSUFBSSxXQUFXLEtBQUssS0FBSyxFQUFFO2dCQUN6QixLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQzthQUNoQztRQUNILENBQUMsQ0FBQyxDQUFDO1FB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QztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMiLCJmaWxlIjoibGliL3JlcXVlc3QvYWRhcHRlcnMvYWRhcHRlcnMuYWJzdHJhY3RzcGVjLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCAoYykgMjAxOCBieSBGaWxlc3RhY2tcbiAqIFNvbWUgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuXG4vKiBpc3RhbmJ1bCBpZ25vcmUgZmlsZSAqL1xuaW1wb3J0ICogYXMgbm9jayBmcm9tICdub2NrJztcbmltcG9ydCAqIGFzIHpsaWIgZnJvbSAnemxpYic7XG5pbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7XG5pbXBvcnQgeyBGc0h0dHBNZXRob2QsIEZzUmVxdWVzdE9wdGlvbnMgfSBmcm9tICcuLi90eXBlcyc7XG5pbXBvcnQgeyBGc0NhbmNlbFRva2VuIH0gZnJvbSAnLi4vdG9rZW4nO1xuaW1wb3J0IHsgRnNSZXF1ZXN0RXJyb3IsIEZzUmVxdWVzdEVycm9yQ29kZSB9IGZyb20gJy4uL2Vycm9yJztcblxuZXhwb3J0IGNvbnN0IGFkYXB0ZXJzSHR0cEFic3RyYWN0ID0gKGFkYXB0ZXI6IGFueSwgYWRhcHRlck5hbWU6IHN0cmluZykgPT4ge1xuICBkZXNjcmliZShgUmVxdWVzdC9BZGFwdGVycy8ke2FkYXB0ZXJOYW1lfWAsICgpID0+IHtcbiAgICBsZXQgc2NvcGU7XG4gICAgY29uc3QgdXJsID0gJ2h0dHBzOi8vc29tZXdyb25nZG9tLm1vYyc7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgIG5vY2suY2xlYW5BbGwoKTtcbiAgICAgIHNjb3BlID0gbnVsbDtcbiAgICB9KTtcblxuICAgIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgICAgc2NvcGUgPSBub2NrKHVybCkuZGVmYXVsdFJlcGx5SGVhZGVycyh7XG4gICAgICAgICdhY2Nlc3MtY29udHJvbC1hbGxvdy1vcmlnaW4nOiByZXEgPT4gcmVxLmhlYWRlcnNbJ29yaWdpbiddLFxuICAgICAgICAnYWNjZXNzLWNvbnRyb2wtYWxsb3ctbWV0aG9kcyc6IHJlcSA9PiByZXEuaGVhZGVyc1snYWNjZXNzLWNvbnRyb2wtcmVxdWVzdC1tZXRob2QnXSxcbiAgICAgICAgJ2FjY2Vzcy1jb250cm9sLWFsbG93LWhlYWRlcnMnOiByZXEgPT4gcmVxLmhlYWRlcnNbJ2FjY2Vzcy1jb250cm9sLXJlcXVlc3QtaGVhZGVycyddLFxuICAgICAgfSk7XG5cbiAgICAgIGlmIChhZGFwdGVyTmFtZSA9PT0gJ3hocicpIHtcbiAgICAgICAgc2NvcGUub3B0aW9ucygvLiovKS5yZXBseSgyMDApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ3JlcXVlc3QgYmFzaWMnLCAoKSA9PiB7XG4gICAgICBpdCgnc2hvdWxkIG1ha2UgY29ycmVjdCByZXF1ZXN0IChodHRwcyknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgbWV0aG9kOiBGc0h0dHBNZXRob2QuR0VULFxuICAgICAgICB9O1xuICAgICAgICBzY29wZS5nZXQoJy8nKS5yZXBseSgyMDAsICdvaycsIHsgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3BsYWluJyB9KTtcblxuICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3RBZGFwdGVyLnJlcXVlc3Qob3B0aW9ucyk7XG5cbiAgICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvRXF1YWwoMjAwKTtcbiAgICAgICAgZXhwZWN0KHJlcy5kYXRhKS50b0VxdWFsKCdvaycpO1xuICAgICAgICBzY29wZS5kb25lKCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBtYWtlIGNvcnJlY3QgcmVxdWVzdCAoaHR0cCknLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGh0dHBVcmwgPSB1cmwucmVwbGFjZSgnaHR0cHMnLCAnaHR0cCcpO1xuXG4gICAgICAgIGNvbnN0IHNjb3BlSHR0cCA9IG5vY2soaHR0cFVybCkuZGVmYXVsdFJlcGx5SGVhZGVycyh7XG4gICAgICAgICAgJ2FjY2Vzcy1jb250cm9sLWFsbG93LW9yaWdpbic6IHJlcSA9PiByZXEuaGVhZGVyc1snb3JpZ2luJ10sXG4gICAgICAgICAgJ2FjY2Vzcy1jb250cm9sLWFsbG93LW1ldGhvZHMnOiByZXEgPT4gcmVxLmhlYWRlcnNbJ2FjY2Vzcy1jb250cm9sLXJlcXVlc3QtbWV0aG9kJ10sXG4gICAgICAgICAgJ2FjY2Vzcy1jb250cm9sLWFsbG93LWhlYWRlcnMnOiByZXEgPT4gcmVxLmhlYWRlcnNbJ2FjY2Vzcy1jb250cm9sLXJlcXVlc3QtaGVhZGVycyddLFxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoYWRhcHRlck5hbWUgPT09ICd4aHInKSB7XG4gICAgICAgICAgc2NvcGVIdHRwLm9wdGlvbnMoLy4qLykucmVwbHkoMjAwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgdXJsOiBodHRwVXJsLFxuICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgfTtcblxuICAgICAgICBzY29wZUh0dHAuZ2V0KCcvJykucmVwbHkoMjAwLCAnb2snLCB7ICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbicgfSk7XG5cbiAgICAgICAgY29uc3QgcmVxdWVzdEFkYXB0ZXIgPSBuZXcgYWRhcHRlcigpO1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpO1xuICAgICAgICBleHBlY3QocmVzLnN0YXR1cykudG9FcXVhbCgyMDApO1xuICAgICAgICBleHBlY3QocmVzLmRhdGEpLnRvRXF1YWwoJ29rJyk7XG4gICAgICAgIHNjb3BlSHR0cC5kb25lKCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBhZGQgaHR0cHMgcHJvdG9jb2wgaWYgbm8gcHJvdG9jb2wgaXMgcHJvdmlkZWQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgdXJsOiB1cmwucmVwbGFjZSgnaHR0cHM6Ly8nLCAnJyksXG4gICAgICAgICAgbWV0aG9kOiBGc0h0dHBNZXRob2QuR0VULFxuICAgICAgICB9O1xuXG4gICAgICAgIHNjb3BlLmdldCgnLycpLnJlcGx5KDIwMCwgJ29rJywgeyAnQ29udGVudC1UeXBlJzogJ3RleHQvcGxhaW4nIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKTtcbiAgICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvRXF1YWwoMjAwKTtcbiAgICAgICAgZXhwZWN0KHJlcy5kYXRhKS50b0VxdWFsKCdvaycpO1xuICAgICAgICBzY29wZS5kb25lKCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgc3RyaW5nIGFzIGRhdGEgcGFyYW0nLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1zZyA9ICdTb21lIHRlc3Qgc3RyZWFtIGRhdGEnO1xuICAgICAgICBjb25zdCBtb2NrID0gamVzdFxuICAgICAgICAgIC5mbigpXG4gICAgICAgICAgLm1vY2tOYW1lKCdidWZmZXJEYXRhJylcbiAgICAgICAgICAubW9ja1JldHVyblZhbHVlKG1zZyk7XG5cbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICBtZXRob2Q6IEZzSHR0cE1ldGhvZC5QT1NULFxuICAgICAgICAgIGRhdGE6IG1zZyxcbiAgICAgICAgfTtcblxuICAgICAgICBzY29wZS5wb3N0KCcvJykucmVwbHkoMjAwLCBmdW5jdGlvbihfLCBkYXRhKSB7XG4gICAgICAgICAgcmV0dXJuIG1vY2soZGF0YSk7XG4gICAgICAgIH0sIHsgJ0NvbnRlbnQtVHlwZSc6ICd0ZXh0L3BsYWluJyB9KTtcblxuICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3RBZGFwdGVyLnJlcXVlc3Qob3B0aW9ucyk7XG4gICAgICAgIGV4cGVjdChyZXMuc3RhdHVzKS50b0VxdWFsKDIwMCk7XG4gICAgICAgIGV4cGVjdChyZXMuZGF0YSkudG9FcXVhbChtc2cpO1xuXG4gICAgICAgIGV4cGVjdChtb2NrKS50b0hhdmVCZWVuTGFzdENhbGxlZFdpdGgobXNnKTtcblxuICAgICAgICBzY29wZS5kb25lKCk7XG4gICAgICB9KTtcblxuICAgICAgLy8gZ3ppcCBzdXBwb3J0IGlzIGhhbmRsZWQgYnkgdGhlIGJyb3dzZXIgb24geGhyIHNpZGVcbiAgICAgIGlmIChhZGFwdGVyTmFtZSAhPT0gJ3hocicpIHtcbiAgICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgZGVmbGF0ZSByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICBtZXRob2Q6IEZzSHR0cE1ldGhvZC5HRVQsXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGNvbnN0IGRhdGEgPSB6bGliLmd6aXBTeW5jKEJ1ZmZlci5mcm9tKCdvaycsICd1dGYtOCcpKTtcbiAgICAgICAgICBzY29wZS5nZXQoJy8nKS5yZXBseSgyMDAsIGRhdGEsIHsgJ0NvbnRlbnQtZW5jb2RpbmcnOiAnZ3ppcCwgZGVmbGF0ZScsICdDb250ZW50LXR5cGUnOiAndGV4dC9wbGFpbicgfSk7XG5cbiAgICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKTtcbiAgICAgICAgICBleHBlY3QocmVzLnN0YXR1cykudG9FcXVhbCgyMDApO1xuICAgICAgICAgIGV4cGVjdChyZXMuZGF0YSkudG9FcXVhbCgnb2snKTtcbiAgICAgICAgICBzY29wZS5kb25lKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIDIwNCBnemlwIHJlcXVlc3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgbWV0aG9kOiBGc0h0dHBNZXRob2QuR0VULFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBzY29wZS5nZXQoJy8nKS5yZXBseSgyMDQsICcnLCB7ICdDb250ZW50LWVuY29kaW5nJzogJ2d6aXAsIGRlZmxhdGUnLCAnQ29udGVudC10eXBlJzogJ3RleHQvcGxhaW4nIH0pO1xuXG4gICAgICAgICAgY29uc3QgcmVxdWVzdEFkYXB0ZXIgPSBuZXcgYWRhcHRlcigpO1xuICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3RBZGFwdGVyLnJlcXVlc3Qob3B0aW9ucyk7XG4gICAgICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvRXF1YWwoMjA0KTtcbiAgICAgICAgICBleHBlY3QocmVzLmRhdGEpLnRvRXF1YWwobnVsbCk7XG5cbiAgICAgICAgICBzY29wZS5kb25lKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIEJ1ZmZlciBhcyBkYXRhIHBhcmFtJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IG1zZyA9ICdTb21lIHRlc3Qgc3RyZWFtIGRhdGEnO1xuXG4gICAgICAgICAgY29uc3QgbW9jayA9IGplc3RcbiAgICAgICAgICAgIC5mbigpXG4gICAgICAgICAgICAubW9ja05hbWUoJ2J1ZmZlckRhdGEnKVxuICAgICAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZSgnb2snKTtcblxuICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLlBPU1QsXG4gICAgICAgICAgICBkYXRhOiBCdWZmZXIuZnJvbShtc2csICd1dGYtOCcpLFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBzY29wZS5wb3N0KCcvJykucmVwbHkoMjAwLCBmdW5jdGlvbihfLCBkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gbW9jayhkYXRhKTtcbiAgICAgICAgICB9LCB7ICdDb250ZW50LXR5cGUnOiAndGV4dC9wbGFpbicgfSk7XG5cbiAgICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKTtcbiAgICAgICAgICBleHBlY3QocmVzLnN0YXR1cykudG9FcXVhbCgyMDApO1xuICAgICAgICAgIGV4cGVjdChtb2NrKS50b0hhdmVCZWVuTGFzdENhbGxlZFdpdGgobXNnKTtcblxuICAgICAgICAgIHNjb3BlLmRvbmUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciB3aGVuIGRhdGEgdHlwZSBpcyB1bnN1cHBvcnRlZCcsICgpID0+IHtcbiAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICBtZXRob2Q6IEZzSHR0cE1ldGhvZC5QT1NULFxuICAgICAgICAgICAgZGF0YTogUmVhZGFibGUuZnJvbShbJ3Rlc3QnXSksXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcblxuICAgICAgICAgIHJldHVybiBleHBlY3QocmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKSkucmVqZWN0cy50b0VxdWFsKGV4cGVjdC5hbnkoRnNSZXF1ZXN0RXJyb3IpKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIGl0KCdzaG91bGQgbWFrZSByZXF1ZXN0IHdpdGggYXV0aCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgYXV0aCA9IHtcbiAgICAgICAgICB1c2VybmFtZTogJ3Rlc3QnLFxuICAgICAgICAgIHBhc3N3b3JkOiAndGVzdCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICBtZXRob2Q6IEZzSHR0cE1ldGhvZC5HRVQsXG4gICAgICAgICAgYXV0aCxcbiAgICAgICAgfTtcblxuICAgICAgICBzY29wZS5vcHRpb25zKCcvJykucmVwbHkoMjAwLCAnb2snKTtcblxuICAgICAgICBzY29wZVxuICAgICAgICAgIC5nZXQoJy8nKVxuICAgICAgICAgIC5iYXNpY0F1dGgoeyB1c2VyOiBhdXRoLnVzZXJuYW1lLCBwYXNzOiBhdXRoLnBhc3N3b3JkIH0pXG4gICAgICAgICAgLnJlcGx5KDIwMCwgJ29rJywgeyAnYWNjZXNzLWNvbnRyb2wtYWxsb3ctb3JpZ2luJzogJyonIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKTtcblxuICAgICAgICBleHBlY3QocmVzLnN0YXR1cykudG9FcXVhbCgyMDApO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgYW4gZXJyb3Igb24gZW1wdHkgdXNlcm5hbWUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGF1dGggPSB7XG4gICAgICAgICAgdXNlcm5hbWU6IG51bGwsXG4gICAgICAgICAgcGFzc3dvcmQ6ICd0ZXN0JyxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgICBhdXRoLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcbiAgICAgICAgcmV0dXJuIGV4cGVjdChyZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpKS5yZWplY3RzLnRvRXF1YWwoZXhwZWN0LmFueShGc1JlcXVlc3RFcnJvcikpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgYW4gZXJyb3Igb24gZW1wdHkgcGFzc3dvcmQnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGF1dGggPSB7XG4gICAgICAgICAgdXNlcm5hbWU6ICd0ZXN0JyxcbiAgICAgICAgICBwYXNzd29yZDogbnVsbCxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgICBhdXRoLFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcbiAgICAgICAgcmV0dXJuIGV4cGVjdChyZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpKS5yZWplY3RzLnRvRXF1YWwoZXhwZWN0LmFueShGc1JlcXVlc3RFcnJvcikpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgb3ZlcndyaXRlIGF1dGggaGVhZGVyIGlmIGF1dGggZGF0YSBpcyBwcm92aWRlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgYXV0aCA9IHtcbiAgICAgICAgICB1c2VybmFtZTogJ3Rlc3QnLFxuICAgICAgICAgIHBhc3N3b3JkOiAndGVzdCcsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICBtZXRob2Q6IEZzSHR0cE1ldGhvZC5HRVQsXG4gICAgICAgICAgYXV0aCxcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiAndGVzdDEyMycsXG4gICAgICAgICAgfSxcbiAgICAgICAgfTtcblxuICAgICAgICBzY29wZS5vcHRpb25zKCcvJykucmVwbHkoMjAwLCAnb2snKTtcblxuICAgICAgICBzY29wZVxuICAgICAgICAgIC5nZXQoJy8nKVxuICAgICAgICAgIC5iYXNpY0F1dGgoeyB1c2VyOiBhdXRoLnVzZXJuYW1lLCBwYXNzOiBhdXRoLnBhc3N3b3JkIH0pXG4gICAgICAgICAgLnJlcGx5KDIwMCwgJ29rJyk7XG5cbiAgICAgICAgY29uc3QgcmVxdWVzdEFkYXB0ZXIgPSBuZXcgYWRhcHRlcigpO1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpO1xuXG4gICAgICAgIGV4cGVjdChyZXMuc3RhdHVzKS50b0VxdWFsKDIwMCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBjb250YWluIGRlZmF1bHQgaGVhZGVycycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgbW9jayA9IGplc3RcbiAgICAgICAgICAuZm4oKVxuICAgICAgICAgIC5tb2NrTmFtZSgnZGVmYXVsdC9oZWFkZXJzJylcbiAgICAgICAgICAubW9ja1JldHVyblZhbHVlKCdvaycpO1xuXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgbWV0aG9kOiBGc0h0dHBNZXRob2QuR0VULFxuICAgICAgICB9O1xuXG4gICAgICAgIHNjb3BlLmdldCgnLycpLnJlcGx5KDIwMCwgZnVuY3Rpb24oXywgZGF0YSkge1xuICAgICAgICAgIHJldHVybiBtb2NrKHRoaXMucmVxLmhlYWRlcnMpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3RBZGFwdGVyLnJlcXVlc3Qob3B0aW9ucyk7XG5cbiAgICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvRXF1YWwoMjAwKTtcbiAgICAgICAgZXhwZWN0KG1vY2spLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICAgIGV4cGVjdC5vYmplY3RDb250YWluaW5nKHsgJ2ZpbGVzdGFjay1zb3VyY2UnOiBleHBlY3QuYW55KFN0cmluZyksICdmaWxlc3RhY2stdHJhY2UtaWQnOiBleHBlY3QuYW55KFN0cmluZyksICdmaWxlc3RhY2stdHJhY2Utc3Bhbic6IGV4cGVjdC5hbnkoU3RyaW5nKSB9KVxuICAgICAgICApO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgb21pdCBkZWZhdWx0IGhlYWRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG1vY2sgPSBqZXN0XG4gICAgICAgICAgLmZuKClcbiAgICAgICAgICAubW9ja05hbWUoJ2RlZmF1bHQvaGVhZGVycycpXG4gICAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZSgnb2snKTtcblxuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgICBmaWxlc3RhY2tIZWFkZXJzOiBmYWxzZSxcbiAgICAgICAgfTtcblxuICAgICAgICBzY29wZS5nZXQoJy8nKS5yZXBseSgyMDAsIGZ1bmN0aW9uKF8sIGRhdGEpIHtcbiAgICAgICAgICByZXR1cm4gbW9jayh0aGlzLnJlcS5oZWFkZXJzKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgcmVxdWVzdEFkYXB0ZXIgPSBuZXcgYWRhcHRlcigpO1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpO1xuXG4gICAgICAgIGV4cGVjdChyZXMuc3RhdHVzKS50b0VxdWFsKDIwMCk7XG4gICAgICAgIGV4cGVjdChtb2NrKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcbiAgICAgICAgICBleHBlY3Qubm90Lm9iamVjdENvbnRhaW5pbmcoeyAnZmlsZXN0YWNrLXNvdXJjZSc6IGV4cGVjdC5hbnkoU3RyaW5nKSwgJ2ZpbGVzdGFjay10cmFjZS1pZCc6IGV4cGVjdC5hbnkoU3RyaW5nKSwgJ2ZpbGVzdGFjay10cmFjZS1zcGFuJzogZXhwZWN0LmFueShTdHJpbmcpIH0pXG4gICAgICAgICk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBza2lwIHVuZGVmaW5lZCBoZWFkZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBtb2NrID0gamVzdFxuICAgICAgICAgIC5mbigpXG4gICAgICAgICAgLm1vY2tOYW1lKCd1bmRlZmluZWQvaGVhZGVycycpXG4gICAgICAgICAgLm1vY2tSZXR1cm5WYWx1ZSgnb2snKTtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICBtZXRob2Q6IEZzSHR0cE1ldGhvZC5HRVQsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgdGVzdDogdW5kZWZpbmVkLFxuICAgICAgICAgIH0sXG4gICAgICAgIH07XG5cbiAgICAgICAgc2NvcGUuZ2V0KCcvJykucmVwbHkoMjAwLCBmdW5jdGlvbihfLCBkYXRhKSB7XG4gICAgICAgICAgcmV0dXJuIG1vY2sodGhpcy5yZXEuaGVhZGVycyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKTtcbiAgICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvRXF1YWwoMjAwKTtcbiAgICAgICAgZXhwZWN0KG1vY2spLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKGV4cGVjdC5ub3Qub2JqZWN0Q29udGFpbmluZyh7IHRlc3Q6IHVuZGVmaW5lZCB9KSk7XG5cbiAgICAgICAgc2NvcGUuZG9uZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgncmVkaXJlY3RzICcsICgpID0+IHtcbiAgICAgIC8vIHhociByZWRpcmVjdHMgYXJlIGhhbmRsZWQgYnkgdGhlIGJyb3dzZXJcbiAgICAgIGlmIChhZGFwdGVyTmFtZSAhPT0gJ3hocicpIHtcbiAgICAgICAgaXQoJ3Nob3VsZCBmb2xsb3cgMzAyIHJlZGlyZWN0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSB7IHRlc3Q6IDEyMyB9O1xuXG4gICAgICAgICAgc2NvcGUuZ2V0KCcvJykucmVwbHkoMzAyLCAnb2snLCB7XG4gICAgICAgICAgICBsb2NhdGlvbjogYCR7dXJsfS9yZXNwYCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBzY29wZS5nZXQoJy9yZXNwJykucmVwbHkoMjAwLCByZXNwb25zZSwge1xuICAgICAgICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcbiAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpO1xuICAgICAgICAgIGV4cGVjdChyZXMuc3RhdHVzKS50b0VxdWFsKDIwMCk7XG4gICAgICAgICAgZXhwZWN0KHJlcy5kYXRhKS50b0VxdWFsKHJlc3BvbnNlKTtcblxuICAgICAgICAgIHNjb3BlLmRvbmUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciB3aGVuIG5vIGxvY2F0aW9uIGlzIHByb3ZpZGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgc2NvcGUuZ2V0KCcvJykucmVwbHkoMzAyLCAnb2snLCB7IGxvY2F0aW9uOiAnJyB9KTtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgICAgICBhd2FpdCByZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpO1xuXG4gICAgICAgICAgICAvLyByZXR1cm4gZXJyb3IgaW4gdHJ5IHdpbGwgbm90IGVtaXQgZXJyb3JcbiAgICAgICAgICAgIGV4cGVjdChmYWxzZSkudG9FcXVhbCh0cnVlKTtcbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGV4cGVjdChlcnIpLnRvRXF1YWwoZXhwZWN0LmFueShGc1JlcXVlc3RFcnJvcikpO1xuICAgICAgICAgICAgZXhwZWN0KGVyci5jb2RlKS50b0VxdWFsKEZzUmVxdWVzdEVycm9yQ29kZS5SRURJUkVDVCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHNjb3BlLmRvbmUoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBlcnJvciAoUkVESVJFQ1QpIG9uIG1heCByZWRpcmVjdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgbWV0aG9kOiBGc0h0dHBNZXRob2QuR0VULFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBpZiAoYWRhcHRlck5hbWUgPT09ICd4aHInKSB7XG4gICAgICAgICAgICBzY29wZS5vcHRpb25zKCcvJykucmVwbHkoMjAwLCAnb2snKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzY29wZVxuICAgICAgICAgICAgLmdldCgnLycpXG4gICAgICAgICAgICAucmVwbHkoMzAyLCAnb2snLCB7XG4gICAgICAgICAgICAgIGxvY2F0aW9uOiBgJHt1cmx9L2FgLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5nZXQoJy9hJylcbiAgICAgICAgICAgIC5yZXBseSgzMDEsICdvaycsIHtcbiAgICAgICAgICAgICAgbG9jYXRpb246IGAke3VybH0vYmAsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmdldCgnL2InKVxuICAgICAgICAgICAgLnJlcGx5KDMwMiwgJ29rJywge1xuICAgICAgICAgICAgICBsb2NhdGlvbjogYCR7dXJsfS9jYCxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZ2V0KCcvYycpXG4gICAgICAgICAgICAucmVwbHkoMzAxLCAnb2snLCB7XG4gICAgICAgICAgICAgIGxvY2F0aW9uOiBgJHt1cmx9L2RgLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5nZXQoJy9kJylcbiAgICAgICAgICAgIC5yZXBseSgzMDIsICdvaycsIHtcbiAgICAgICAgICAgICAgbG9jYXRpb246IGAke3VybH0vZWAsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmdldCgnL2UnKVxuICAgICAgICAgICAgLnJlcGx5KDMwMSwgJ29rJywge1xuICAgICAgICAgICAgICBsb2NhdGlvbjogYCR7dXJsfS9mYCxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZ2V0KCcvZicpXG4gICAgICAgICAgICAucmVwbHkoMzAyLCAnb2snLCB7XG4gICAgICAgICAgICAgIGxvY2F0aW9uOiBgJHt1cmx9L2dgLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5nZXQoJy9nJylcbiAgICAgICAgICAgIC5yZXBseSgzMDEsICdvaycsIHtcbiAgICAgICAgICAgICAgbG9jYXRpb246IGAke3VybH0vaGAsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmdldCgnL2gnKVxuICAgICAgICAgICAgLnJlcGx5KDMwMiwgJ29rJywge1xuICAgICAgICAgICAgICBsb2NhdGlvbjogYCR7dXJsfS9pYCxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZ2V0KCcvaScpXG4gICAgICAgICAgICAucmVwbHkoMzAxLCAnb2snLCB7XG4gICAgICAgICAgICAgIGxvY2F0aW9uOiBgJHt1cmx9L2pgLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5nZXQoJy9qJylcbiAgICAgICAgICAgIC5yZXBseSgzMDIsICdvaycsIHtcbiAgICAgICAgICAgICAgbG9jYXRpb246IGAke3VybH0va2AsXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgICAgICBhd2FpdCByZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpO1xuXG4gICAgICAgICAgICAvLyByZXR1cm4gZXJyb3IgaW4gdHJ5IHdpbGwgbm90IGVtaXQgZXJyb3JcbiAgICAgICAgICAgIGV4cGVjdChmYWxzZSkudG9FcXVhbCh0cnVlKTtcbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGV4cGVjdChlcnIpLnRvRXF1YWwoZXhwZWN0LmFueShGc1JlcXVlc3RFcnJvcikpO1xuICAgICAgICAgICAgZXhwZWN0KGVyci5jb2RlKS50b0VxdWFsKEZzUmVxdWVzdEVycm9yQ29kZS5SRURJUkVDVCk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgc2NvcGUuZG9uZSgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIHRocm93IGVycm9yIG9uIHJlZGlyZWN0IGxvb3AnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgbWV0aG9kOiBGc0h0dHBNZXRob2QuR0VULFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICBzY29wZVxuICAgICAgICAgICAgLmdldCgnLycpXG4gICAgICAgICAgICAucmVwbHkoMzAyLCAnb2snLCB7IGxvY2F0aW9uOiBgJHt1cmx9L2FgIH0pXG4gICAgICAgICAgICAuZ2V0KCcvYScpXG4gICAgICAgICAgICAucmVwbHkoMzAyLCAnb2snLCB7IGxvY2F0aW9uOiBgJHt1cmx9L2FgIH0pXG4gICAgICAgICAgICAuZ2V0KCcvYScpXG4gICAgICAgICAgICAucmVwbHkoMjAwLCAnb2snKTtcblxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgICAgICBhd2FpdCByZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpO1xuXG4gICAgICAgICAgICAvLyByZXR1cm4gZXJyb3IgaW4gdHJ5IHdpbGwgbm90IGVtaXQgZXJyb3JcbiAgICAgICAgICAgIGV4cGVjdChmYWxzZSkudG9FcXVhbCh0cnVlKTtcbiAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgIGV4cGVjdChlcnIpLnRvRXF1YWwoZXhwZWN0LmFueShGc1JlcXVlc3RFcnJvcikpO1xuICAgICAgICAgICAgZXhwZWN0KGVyci5jb2RlKS50b0VxdWFsKEZzUmVxdWVzdEVycm9yQ29kZS5SRURJUkVDVCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChhZGFwdGVyTmFtZSA9PT0gJ3hocicpIHtcbiAgICAgIGRlc2NyaWJlKCdyZXF1ZXN0IGZvcm0nLCAoKSA9PiB7XG4gICAgICAgIGl0KCdTaG91bGQgc2VuZCBmb3JtIGRhdGEnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgZm9ybSA9IG5ldyBGb3JtRGF0YSgpO1xuXG4gICAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgbWV0aG9kOiBGc0h0dHBNZXRob2QuUE9TVCxcbiAgICAgICAgICAgIGRhdGE6IGZvcm0sXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIGNvbnN0IHJlc3AgPSB7IGZvcm06ICdvaycgfTtcblxuICAgICAgICAgIHNjb3BlLnBvc3QoJy8nKS5yZXBseSgyMDAsIHJlc3AsIHsgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9KTtcblxuICAgICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcbiAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCByZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpO1xuXG4gICAgICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvRXF1YWwoMjAwKTtcbiAgICAgICAgICBleHBlY3QocmVzLmRhdGEpLnRvRXF1YWwocmVzcCk7XG5cbiAgICAgICAgICBzY29wZS5kb25lKCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgZGVzY3JpYmUoJzR4eCBhbmQgNXh4IGVycm9ycyBoYW5kbGluZycsICgpID0+IHtcbiAgICAgIGl0KCdzaG91bGQgaGFuZGxlIDR4eCByZXNwb25zZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICBtZXRob2Q6IEZzSHR0cE1ldGhvZC5HRVQsXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgZXJyb3JSZXNwID0geyB0ZXN0OiAxMjMgfTtcblxuICAgICAgICBzY29wZS5nZXQoJy8nKS5yZXBseSg0MDQsIGVycm9yUmVzcCwge1xuICAgICAgICAgICdDb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgcmVxdWVzdEFkYXB0ZXIgPSBuZXcgYWRhcHRlcigpO1xuICAgICAgICAgIGF3YWl0IHJlcXVlc3RBZGFwdGVyLnJlcXVlc3Qob3B0aW9ucyk7XG4gICAgICAgICAgZXhwZWN0KGZhbHNlKS50b0VxdWFsKHRydWUpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBleHBlY3QoZXJyKS50b0VxdWFsKGV4cGVjdC5hbnkoRnNSZXF1ZXN0RXJyb3IpKTtcbiAgICAgICAgICBleHBlY3QoZXJyLmNvZGUpLnRvRXF1YWwoRnNSZXF1ZXN0RXJyb3JDb2RlLlJFUVVFU1QpO1xuICAgICAgICAgIGV4cGVjdChlcnIucmVzcG9uc2Uuc3RhdHVzKS50b0VxdWFsKDQwNCk7XG4gICAgICAgICAgZXhwZWN0KGVyci5yZXNwb25zZS5kYXRhKS50b0VxdWFsKGVycm9yUmVzcCk7XG4gICAgICAgIH1cblxuICAgICAgICBzY29wZS5kb25lKCk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBoYW5kbGUgNXh4IHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBlcnJvclJlc3AgPSB7IHRlc3Q6IDEyMyB9O1xuXG4gICAgICAgIHNjb3BlLmdldCgnLycpLnJlcGx5KDUwMSwgZXJyb3JSZXNwLCB7XG4gICAgICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgICAgYXdhaXQgcmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKTtcbiAgICAgICAgICBleHBlY3QoZmFsc2UpLnRvRXF1YWwodHJ1ZSk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGV4cGVjdChlcnIpLnRvRXF1YWwoZXhwZWN0LmFueShGc1JlcXVlc3RFcnJvcikpO1xuICAgICAgICAgIGV4cGVjdChlcnIuY29kZSkudG9FcXVhbChGc1JlcXVlc3RFcnJvckNvZGUuU0VSVkVSKTtcbiAgICAgICAgICBleHBlY3QoZXJyLnJlc3BvbnNlLnN0YXR1cykudG9FcXVhbCg1MDEpO1xuICAgICAgICAgIGV4cGVjdChlcnIucmVzcG9uc2UuZGF0YSkudG9FcXVhbChlcnJvclJlc3ApO1xuICAgICAgICB9XG5cbiAgICAgICAgc2NvcGUuZG9uZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpZiAoYWRhcHRlck5hbWUgPT09ICd4aHInKSB7XG4gICAgICBkZXNjcmliZSgncHJvZ3Jlc3MgZXZlbnQnLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzaG91bGQgaGFuZGxlIHVwbG9hZCBwcm9ncmVzcycsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICBjb25zdCBwcm9ncmVzc1NweSA9IGplc3RcbiAgICAgICAgICAgIC5mbigpXG4gICAgICAgICAgICAubW9ja05hbWUoJ2J1ZmZlckRhdGEnKVxuICAgICAgICAgICAgLm1vY2tSZXR1cm5UaGlzKCk7XG4gICAgICAgICAgY29uc3QgYnVmID0gQnVmZmVyLmFsbG9jKDEwMjQpO1xuICAgICAgICAgIGJ1Zi5maWxsKCdhJyk7XG5cbiAgICAgICAgICBjb25zdCBvcHRpb25zOiBGc1JlcXVlc3RPcHRpb25zID0ge1xuICAgICAgICAgICAgdXJsOiBgJHt1cmx9L3Byb2dyZXNzYCxcbiAgICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLlBPU1QsXG4gICAgICAgICAgICBvblByb2dyZXNzOiBwcm9ncmVzc1NweSxcbiAgICAgICAgICAgIGRhdGE6IGJ1ZixcbiAgICAgICAgICB9O1xuXG4gICAgICAgICAgc2NvcGUub3B0aW9ucygnL3Byb2dyZXNzJykucmVwbHkoMjAwLCAnb2snLCB7XG4gICAgICAgICAgICAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgc2NvcGUucG9zdCgnL3Byb2dyZXNzJykucmVwbHkoMjAwLCAnb2snLCB7XG4gICAgICAgICAgICAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY29uc3QgcmVxdWVzdEFkYXB0ZXIgPSBuZXcgYWRhcHRlcigpO1xuICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHJlcXVlc3RBZGFwdGVyLnJlcXVlc3Qob3B0aW9ucyk7XG4gICAgICAgICAgLy8gZm9yIGpzZG9tIHdlIGNhbm5vdCBjaGVjayBwcm9ncmVzcyBldmVudCBjb3JyZWN0bHlcbiAgICAgICAgICBleHBlY3QocHJvZ3Jlc3NTcHkpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBkZXNjcmliZSgnY2FuY2VsVG9rZW4nLCAoKSA9PiB7XG4gICAgICBpdCgnU2hvdWxkIHRocm93IGFib3J0IHJlcXVlc3Qgd2hlbiB0b2tlbiB3aWxsIGJlIGNhbGxlZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgdG9rZW4gPSBuZXcgRnNDYW5jZWxUb2tlbigpO1xuXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgbWV0aG9kOiBGc0h0dHBNZXRob2QuR0VULFxuICAgICAgICAgIGNhbmNlbFRva2VuOiB0b2tlbixcbiAgICAgICAgfTtcblxuICAgICAgICBzY29wZVxuICAgICAgICAgIC5nZXQoJy8nKVxuICAgICAgICAgIC5kZWxheSgyMDAwKVxuICAgICAgICAgIC5yZXBseSgyMDAsICdvaycsIHtcbiAgICAgICAgICAgICdDb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgdG9rZW4uY2FuY2VsKCk7XG4gICAgICAgIH0sIDEwMCk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgICAgYXdhaXQgcmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKTtcblxuICAgICAgICAgIC8vIHJldHVybiBlcnJvciBpbiB0cnkgd2lsbCBub3QgZW1pdCBlcnJvclxuICAgICAgICAgIGV4cGVjdChmYWxzZSkudG9FcXVhbCh0cnVlKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgZXhwZWN0KGVycikudG9FcXVhbChleHBlY3QuYW55KEZzUmVxdWVzdEVycm9yKSk7XG4gICAgICAgICAgZXhwZWN0KGVyci5jb2RlKS50b0VxdWFsKEZzUmVxdWVzdEVycm9yQ29kZS5BQk9SVEVEKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIGl0KCdTaG91bGQgbm90IHRocm93IHVuZGVmaW5lZCBlcnJvciB3aGVuIGNhbmNlbCB0b2tlbiB3aWxsIGJlIGNhbGxlZCBhZnRlciByZXF1ZXN0IGZpbmlzaGVkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCB0b2tlbiA9IG5ldyBGc0NhbmNlbFRva2VuKCk7XG5cbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICBtZXRob2Q6IEZzSHR0cE1ldGhvZC5HRVQsXG4gICAgICAgICAgY2FuY2VsVG9rZW46IHRva2VuLFxuICAgICAgICB9O1xuXG4gICAgICAgIHNjb3BlLmdldCgnLycpLnJlcGx5KDIwMCwgJ29rJywge1xuICAgICAgICAgICdDb250ZW50LXR5cGUnOiAndGV4dC9wbGFpbicsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKTtcbiAgICAgICAgdG9rZW4uY2FuY2VsKCk7XG5cbiAgICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvRXF1YWwoMjAwKTtcbiAgICAgICAgZXhwZWN0KHJlcy5kYXRhKS50b0VxdWFsKCdvaycpO1xuXG4gICAgICAgIHNjb3BlLmRvbmUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ05ldHdvcmsgZXJyb3JzJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBhbiBlcnJvciBvbiBkb21haW4gbm90IGZvdW5kJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIHVybDogJ2h0dHBzOi8vc29tZS1iYWRkLXVybC5lcicsXG4gICAgICAgICAgbWV0aG9kOiBGc0h0dHBNZXRob2QuR0VULFxuICAgICAgICB9O1xuXG4gICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcbiAgICAgICAgcmV0dXJuIGV4cGVjdChyZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpKS5yZWplY3RzLnRvRXF1YWwoZXhwZWN0LmFueShGc1JlcXVlc3RFcnJvcikpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdTaG91bGQgdGhyb3cgYW4gRmlsZXN0YWNrRXJyb3Igb24gc29ja2V0IGFib3J0IHdpdGggRnNSZXF1ZXN0RXJyb3JDb2RlLlRJTUVPVVRFRCBjb2RlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgICB0aW1lb3V0OiA1MCxcbiAgICAgICAgfTtcblxuICAgICAgICBzY29wZVxuICAgICAgICAgIC5nZXQoJy8nKVxuICAgICAgICAgIC5kZWxheSgyMDAwKVxuICAgICAgICAgIC5yZXBseSgyMDAsICdvaycsIHtcbiAgICAgICAgICAgICdDb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgICAgYXdhaXQgcmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKTtcblxuICAgICAgICAgIC8vIHJldHVybiBlcnJvciBpbiB0cnkgd2lsbCBub3QgZW1pdCBlcnJvclxuICAgICAgICAgIGV4cGVjdChmYWxzZSkudG9FcXVhbCh0cnVlKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgZXhwZWN0KGVycikudG9FcXVhbChleHBlY3QuYW55KEZzUmVxdWVzdEVycm9yKSk7XG4gICAgICAgICAgZXhwZWN0KGVyci5jb2RlKS50b0VxdWFsKEZzUmVxdWVzdEVycm9yQ29kZS5USU1FT1VUKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNjb3BlLmRvbmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnU2hvdWxkIHRocm93IGFuIEZpbGVzdGFja0Vycm9yIG9uIHJlc3BvbnNlIEVDT05OUkVGVVNFRCBlcnJvciB3aXRoIEZzUmVxdWVzdEVycm9yQ29kZS5ORVRXT1JLIGNvZGUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgbWV0aG9kOiBGc0h0dHBNZXRob2QuR0VULFxuICAgICAgICB9O1xuXG4gICAgICAgIHNjb3BlLmdldCgnLycpLnJlcGx5V2l0aEVycm9yKHsgY29kZTogJ0VDT05OUkVGVVNFRCcgfSk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgICAgYXdhaXQgcmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKTtcblxuICAgICAgICAgIC8vIHJldHVybiBlcnJvciBpbiB0cnkgd2lsbCBub3QgZW1pdCBlcnJvclxuICAgICAgICAgIGV4cGVjdChmYWxzZSkudG9FcXVhbCh0cnVlKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgZXhwZWN0KGVycikudG9FcXVhbChleHBlY3QuYW55KEZzUmVxdWVzdEVycm9yKSk7XG4gICAgICAgICAgZXhwZWN0KGVyci5jb2RlKS50b0VxdWFsKEZzUmVxdWVzdEVycm9yQ29kZS5ORVRXT1JLKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNjb3BlLmRvbmUoKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnU2hvdWxkIHRocm93IGFuIEZpbGVzdGFja0Vycm9yIG9uIHJlc3BvbnNlIEVDT05OUkVTRVQgZXJyb3Igd2l0aCBGc1JlcXVlc3RFcnJvckNvZGUuTkVUV09SSyBjb2RlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgfTtcblxuICAgICAgICBzY29wZS5nZXQoJy8nKS5yZXBseVdpdGhFcnJvcih7IGNvZGU6ICdFQ09OTlJFU0VUJyB9KTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcbiAgICAgICAgICBhd2FpdCByZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpO1xuXG4gICAgICAgICAgLy8gcmV0dXJuIGVycm9yIGluIHRyeSB3aWxsIG5vdCBlbWl0IGVycm9yXG4gICAgICAgICAgZXhwZWN0KGZhbHNlKS50b0VxdWFsKHRydWUpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBleHBlY3QoZXJyKS50b0VxdWFsKGV4cGVjdC5hbnkoRnNSZXF1ZXN0RXJyb3IpKTtcbiAgICAgICAgICBleHBlY3QoZXJyLmNvZGUpLnRvRXF1YWwoRnNSZXF1ZXN0RXJyb3JDb2RlLk5FVFdPUkspO1xuICAgICAgICB9XG5cbiAgICAgICAgc2NvcGUuZG9uZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdTaG91bGQgdGhyb3cgYW4gRmlsZXN0YWNrRXJyb3Igb24gcmVzcG9uc2UgRU5PVEZPVU5EIGVycm9yIHdpdGggRnNSZXF1ZXN0RXJyb3JDb2RlLk5FVFdPUksgY29kZScsIGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICBtZXRob2Q6IEZzSHR0cE1ldGhvZC5HRVQsXG4gICAgICAgIH07XG5cbiAgICAgICAgc2NvcGUuZ2V0KCcvJykucmVwbHlXaXRoRXJyb3IoeyBjb2RlOiAnRU5PVEZPVU5EJyB9KTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHJlcXVlc3RBZGFwdGVyID0gbmV3IGFkYXB0ZXIoKTtcbiAgICAgICAgICBhd2FpdCByZXF1ZXN0QWRhcHRlci5yZXF1ZXN0KG9wdGlvbnMpO1xuXG4gICAgICAgICAgLy8gcmV0dXJuIGVycm9yIGluIHRyeSB3aWxsIG5vdCBlbWl0IGVycm9yXG4gICAgICAgICAgZXhwZWN0KGZhbHNlKS50b0VxdWFsKHRydWUpO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBleHBlY3QoZXJyKS50b0VxdWFsKGV4cGVjdC5hbnkoRnNSZXF1ZXN0RXJyb3IpKTtcbiAgICAgICAgICBleHBlY3QoZXJyLmNvZGUpLnRvRXF1YWwoRnNSZXF1ZXN0RXJyb3JDb2RlLk5FVFdPUkspO1xuICAgICAgICB9XG5cbiAgICAgICAgc2NvcGUuZG9uZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdTaG91bGQgYWJvcnQgcmVxdWVzdCBvbiB0aW1lb3V0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgIG1ldGhvZDogRnNIdHRwTWV0aG9kLkdFVCxcbiAgICAgICAgICB0aW1lb3V0OiAxMDAwLFxuICAgICAgICB9O1xuXG4gICAgICAgIHNjb3BlXG4gICAgICAgICAgLmdldCgnLycpXG4gICAgICAgICAgLmRlbGF5KDIwMDApXG4gICAgICAgICAgLnJlcGx5KDIwMCwgJ29rJyk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCByZXF1ZXN0QWRhcHRlciA9IG5ldyBhZGFwdGVyKCk7XG4gICAgICAgICAgYXdhaXQgcmVxdWVzdEFkYXB0ZXIucmVxdWVzdChvcHRpb25zKTtcblxuICAgICAgICAgIC8vIHJldHVybiBlcnJvciBpbiB0cnkgd2lsbCBub3QgZW1pdCBlcnJvclxuICAgICAgICAgIGV4cGVjdChmYWxzZSkudG9FcXVhbCh0cnVlKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgZXhwZWN0KGVycikudG9FcXVhbChleHBlY3QuYW55KEZzUmVxdWVzdEVycm9yKSk7XG4gICAgICAgICAgZXhwZWN0KGVyci5jb2RlKS50b0VxdWFsKEZzUmVxdWVzdEVycm9yQ29kZS5USU1FT1VUKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNjb3BlLmRvbmUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn07XG4iXX0=
